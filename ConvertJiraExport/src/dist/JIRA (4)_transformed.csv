Issue key,Priority,Summary,Issue type,Description,Status,Component,Reporter,Assignee,Created,Updated,Resolved,Resolution,EPD team,Epic link,Epic name,Story points,Fix versions,Last Sprint,Sprints,Labels,Original estimate,Remaining estimate,Time spent,Flagged
EIP1-4500,Three,,Story,"*As an* ERO
*I want* the register check to request EMSs to check historical registers
*So that* I can still find electors who are no longer on current registers

----

h2. Technical Notes

[https://github.com/cabinetoffice/eip-ero-register-checker-api/blob/eip-main/src/main/resources/openapi/sqs/rca-sqs-messaging.yaml#L102|https://github.com/cabinetoffice/eip-ero-register-checker-api/blob/eip-main/src/main/resources/openapi/sqs/rca-sqs-messaging.yaml#L102]

This looks done from a RC API perspective. Will be OE dev to integrate

This needs extended wit         h the historicalSearch flag set to true:

[https://github.com/cabinetoffice/eip-ero-overseas-applications-api/blob/eip-main/src/main/kotlin/uk/gov/dluhc/overseasapplicationsapi/mapper/RegisterCheckMapper.kt#L32|https://github.com/cabinetoffice/eip-ero-overseas-applications-api/blob/eip-main/src/main/kotlin/uk/gov/dluhc/overseasapplicationsapi/mapper/RegisterCheckMapper.kt#L32]

The historical register check will be called/queued automatically on creation of the application or on the editing of details sent to EMSs for validation.

h2. Acceptance Criteria

h3. AC1: Queue Register Check

*Given* an application is received
*When* the application is not flagged as a “{{previouslyRegisteredOverseas""}}
*Then* an SQS message will be sent to the EROP Register Checker service requesting a EMS register check
*And* the application will be saved indicating that the register check has been requested

h3. AC2: EMS Response Received

*Given* an application has requested a register check
*When* the EROP register check service processes the a response from the EMS and sends a SQS message back to the OE API service
*Then* the response will update the application with the status returned.",To Do,,Shane.yin,,08/Mar/23 4:42 PM,08/Sep/23 2:48 PM,,,,EIP1-7230,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-4813,Three,,Story,"As an authorised user in the Identity Tab

I WANT to be able to confirm the identity check

So that I can process the application

*Context*

Once all relevant checks has been made ie all supporting documents has been review and satisfied as adequate identity evidence

Then EROs can confirm the identity check as verified

*Assumptions*

* Autocheck has return a no record and not matched results OR
* Supporting documents has been provided in support of the application and/or
* Additional documentation has been provided 



*Screen design before determination* 

!image-20230912-032157.png|width=997,height=974!



*Screen design after determination* 

!image-20230912-032751.png|width=984,height=906!



h3. Acceptance Criteria



*AC1 accept identity* 

Given that the authorised user is in the identity tab

AND is satisfied that all checks has been done and verified

WHEN the user clicks on the Confirm Identity  button

THEN a banner with text confirmation message, ERO name and date and time of confirmation and undo button will be displayed  

AND confirmation will be recorded (See [https://technologyprogramme.atlassian.net/browse/EIP1-4811|https://technologyprogramme.atlassian.net/browse/EIP1-4811|smart-link] 

AND the identity status will change from ‘pending’ to 'verified'



*AC1 Reject identity* 

Given that the authorised user is in the identity tab

AND is satisfied that all checks has been done and verified

WHEN the user clicks on the reject Identity  button

THEN a banner with text rejection message, ERO name and date and time of rejection and undo button will be displayed  

AND confirmation will be recorded (See [https://technologyprogramme.atlassian.net/browse/EIP1-4811|https://technologyprogramme.atlassian.net/browse/EIP1-4811|smart-link] 

AND the identity status will change from ‘pending’ to 'rejected'



*AC2*

Given that the authorised user is in the identity tab

AND an application has been approved or rejected in the ‘determinations’ tab 

WHEN the user clicks confirm identity or Undo 

THEN the identity tab status should not change ",To Do,,yusuf.eldin,,18/Mar/23 10:45 AM,12/Sep/23 4:43 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4815,Three,,Story,"As an authorised user reviewing identity documents

I WANT to be able to record acceptance of supporting document

So that I can process the identity of the applicant

*Context*

If applicant is not found or has no match from the NINO autocheck and have supporting documents to support their identity

Then the EROs will review these documents and can subsequently accept the documents 



*Screen Design*

!identitty updated 2 -20230912-013656.png|width=967,height=674!



+Accepted Document List+

!image-20230313-120616.png|width=757,height=237!

h3. Acceptance Criteria

*AC1: Accept document* 

GIVEN that the user has navigated to the document for acceptance

WHEN the user has clicked on the Accept Document button

THEN the accepted document will be listed in the Accepted document list

AND the document status (See [https://technologyprogramme.atlassian.net/browse/EIP1-4814|https://technologyprogramme.atlassian.net/browse/EIP1-4814|smart-link]   ) is updated to reflect acceptance",To Do,,yusuf.eldin,,18/Mar/23 10:47 AM,12/Sep/23 3:27 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4816,Three,,Story,"As an authorised user reviewing identity documents

I WANT to be able to view uploaded supporting document

So that I can process the identity of the applicant

*Context*

If applicant is not found or has no match from the NINO autocheck and have supporting documents to support their identity

Then the EROs will review these documents and subsequently accept or reject the supporting documents and provided rejection reasons.

*Designs*

!image-20230912-022607.png|width=1116,height=592!



*AC1: Review Document*

GIVEN that the user has navigated to the document for acceptance

WHEN the user has clicked on the Review Document button or the document link 

THEN a document viewer will load the document in read-only mode",To Do,,yusuf.eldin,,18/Mar/23 10:47 AM,12/Sep/23 3:27 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4817,Three,,Story,"As an authorised user in the Identity Tab

AND reviewing supporting document for identity checks

I WANT to be able to Reject a document and request a new document

So that I can continue to process the application

 

h3. *Context*

The ERO has reviewed all the supporting documents and may need to reject and request a new document. This feature will allow the user to reject and input a reason for the rejection

 

*Notes*

* Providing a rejection reason for a document is optional

h3. *Screen Designs*

 

 *Step1: Reject document*

!image-20230912-022522.png|width=1116,height=592!

 

*Step2: Select rejection reason and additional explanation*

!rejection reasons -20230912-021312.png|width=931,height=936!



 *Step3: Select rejection reason and additional explanation*

!image-20230418-005628.png|width=910,height=1047!

 

h3. Acceptance Criteria

 

*AC1 a: Reject uploaded document reason*

GIVEN that the authorised user is in the Identity Tab

AND is reviewing uploaded documents in the ‘Documents for review’ section

WHEN the user clicks the ‘Reject document’ button

THEN the UI will show the reject document reasons

AND a text box to add additional explanation for rejection

AND a Reject document and cancel button

 

*AC2a: Reject CTA*

GIVEN that the authorised user is rejecting a document under review

AND *selects rejection reasons*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection and a link to the document

AND where *multiple rejection reasons are selected, display the reasons in the same field separated by commas*

AND the document status will be updated (See [https://technologyprogramme.atlassian.net/browse/EIP1-4814|https://technologyprogramme.atlassian.net/browse/EIP1-4814|smart-link]  )

 

*AC2b: Reject with no reason selected*

 

GIVEN that the authorised user is rejecting a document under review

*AND does not select a rejection reason*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ERO name and date and time of rejection

AND *rejected reason* will show *‘not provided’*

AND the ‘Undo reject document’ button will be displayed

AND the document status will be updated (See [https://technologyprogramme.atlassian.net/browse/EIP1-4814|https://technologyprogramme.atlassian.net/browse/EIP1-4814|smart-link]  )

 

*AC2b: Reject CTA with additional information*

 

GIVEN that the authorised user is rejecting a document under review

*AND adds additional information*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection

AND an extra field *‘additional information’ will show below.*

AND the document status will be updated (See( [https://technologyprogramme.atlassian.net/browse/EIP1-4814|https://technologyprogramme.atlassian.net/browse/EIP1-4814|smart-link]  )",To Do,,yusuf.eldin,,18/Mar/23 10:48 AM,12/Sep/23 3:27 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4820,Three,,Story,"As an authorised user in the Identity Tab

And the auto check has returned with not found or a not matched result

I WANT to be able to record documents that has been uploaded or seen in support of the Identity check

So that I can process this application

h2. *Context*

When Identity auto check returns not provided or not matched NINO check then supporting documents will need to be added in support of the applicants overseas elector application. 

h2. *Notes.*

* the file restrictions are:

All files must be in PNG, GIF, JPG or PDF format, maximum 20MB

This ticket will cover both uploading and adding offline documents 

* API story for uploading documents [https://technologyprogramme.atlassian.net/browse/EIP1-7206|https://technologyprogramme.atlassian.net/browse/EIP1-7206|smart-link] 
* API story for offline documents [https://technologyprogramme.atlassian.net/browse/EIP1-7208|https://technologyprogramme.atlassian.net/browse/EIP1-7208|smart-link] 
* Spinner element may be needed as upload/add is not synchronous add in AC’s around the loading state 

h2. *Screen designs*



!identity updated-20230912-013548.png|width=957,height=770!



h3. *Uploaded documents view*

*Uploaded documents appear in a list under ‘Documents for review’ section with Review, Accept and Reject buttons and a link to the uploaded document.*



!identitty updated 2 -20230912-013656.png|width=967,height=674!



h3. *Drop down list:*



*Primary Identification Documents*

 Passport

ID card issued in EEA

UK-issued biometric immigration document

NI-issued electoral identity card

UK/CD-issued photocard driving licence

 

*Trusted Government Documents*

Birth certificate (UK or CD)

Marriage or civil partnership certificate (UK or CD)

Adoption certificate (UK or CD)

Firearms certificate (UK or CD)

UK-issued driving licence (not in photocard form)

Valid non-UK issued photocard driving licence

Police bail sheet (UK or CD)

 

*Financial and Social History Documents*

Mortgage statement 

Bank or building society statement or letter confirming account 

Credit card statement 

Pensions statement 

Council tax demand letter or statement

Utility bill

P45 or P60 issued by employer/former employer

Statement of benefits or entitlement to benefits



h2. *Acceptance Criteria*

*Upload Document*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

*AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Choose file’ CTA

THEN the upload file facility will allow a user to upload a document [https://technologyprogramme.atlassian.net/browse/EIP1-7206|https://technologyprogramme.atlassian.net/browse/EIP1-7206|smart-link]

AND ‘No File chosen’ should be replaced by the uploaded file name

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, Accept and Reject buttons and a link to the document

*AC4:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document 

THEN the document should show in a ‘loading state’ in the documents for review tab, until the upload is confirmed 



*Add document as seen*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

 *AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Add document’ CTA

THEN the user will see the document in the ‘Documents for review’ section [https://technologyprogramme.atlassian.net/browse/EIP1-7208|https://technologyprogramme.atlassian.net/browse/EIP1-7208|smart-link] 

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has added a document as seen

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, ‘Accept document as seen’ and ‘Reject document as seen’ buttons",To Do,,yusuf.eldin,,18/Mar/23 10:50 AM,12/Sep/23 3:53 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4821,Three,,Story,"As an authorised user in the Identity Tab

AND reviewing supporting document for identity checks

I WANT to be able to send a rejection notification with reasons for the rejection to the applicant

*Context*

The ERO has reviewed all the supporting documents and may need to reject the document. This story then allows the EROs to send a notification either by GOVT Notify or Email. In the content of the notification would list the document(s) that had been rejected and the reasons why for each. Also any other information from the ERO to the applicant ie please send in new documentation for review

*Screen Designs*

*NOTE: Latest Designs will need to replace the following images*

Step1: User has entered in rejection reasons for the document and rejected it

!image-20230912-024019.png|width=1110,height=1116!



Step3: Send Rejection communication

!image-20230912-024218.png|width=995,height=891!



Step4: Confirmation of message sent

!image-20230311-163429.png|width=866,height=533!

h2. Acceptance Criteria

*AC1: Send rejection communication*

GIVEN the the authorised user has rejected a document under review

AND wishes to send comms to the applicant by selected comms method ie either by Govt notify or email

AND has entered a message ie request new document etc

WHEN the user selects the Send communication button

THEN the message will be sent via the selected communication method [https://technologyprogramme.atlassian.net/browse/EIP1-7435|https://technologyprogramme.atlassian.net/browse/EIP1-7435|smart-link] 

AND a banner with sent confirmation, name and date and time will display",To Do,,yusuf.eldin,,18/Mar/23 10:50 AM,12/Sep/23 3:53 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-4822,Three,,Story,"As an authorised user reviewing identity documents

I WANT to be able to record acceptance of supporting document

So that I can process the identity of the applicant

 

h3. *Context*

If applicant is not found or has no match from the NINO autocheck and have added supporting documents to support their identity

Then the EROs will review these documents and subsequently accept or reject the supporting documents and provided rejection reasons.

 

*Notes*

Undo accepted document will be handled in a subsequent ticket

h3. *Screen Design*

!image-20230517-081341.png|width=50%!

 

*Accepted Document List*

!accepted new -20230517-081245.png|width=50%!

 

h3. Acceptance Criteria

 

*AC1: Accept uploaded document*

GIVEN that the citizen has uploaded a document

AND the ERO has navigated to the ‘Documents for review’ section

WHEN the user has clicked on the Accept Document button

THEN the accepted document will be listed in the Accepted document list

AND the document status (See [https://technologyprogramme.atlassian.net/browse/EIP1-3767|https://technologyprogramme.atlassian.net/browse/EIP1-3767|smart-link] ) is updated to reflect acceptance

AND the accepted document will display with ‘Accepted by’ (ERO name), date and time of acceptance, and a link to the document

(See designs above)",To Do,,yusuf.eldin,,18/Mar/23 10:51 AM,12/Sep/23 2:54 AM,,,,EIP1-4308,,,,,,Beta|OE|RefineInProgress|Valtech,,,,
EIP1-4945,Three,,Story,"*As an* ERO
*I want* to know when the DWP service returns a response to indicate there were too many matches to identify a single citzen
*So that* I review the electors details, update as needed to allow a DWP re-check.

----

h3. Technical Notes

The DWP service has returned a 422 response in request to a match request, this request included the persons full name, dob, address and last 4 digits of their NINO number and the service still found more than 1 individual.

----

h3. {color:#bf2600}Questions{color}

{color:#bf2600}What response/status should we return / show to EROs?{color}
{color:#bf2600}We currently only have match, no-match and match-deceased as responses.{color}
{color:#bf2600}We could send no-match but this is not strictly true.{color}
{color:#bf2600}Or we could add a new status: multiple-matches - this would involve changes to the existing VAC API and UI to support any new status.{color}",To Do,,Krister Bone,,22/Mar/23 5:30 PM,11/Sep/23 4:07 PM,,,,EIP1-4160,,,,OAVA/OE Sprint 13,OAVA/OE Sprint 13,API|Beta|OAVA|OE|RefineInProgress|Valtech,,,,
EIP1-5239,Three,,Story,"As an authorised user in the Identity Tab

I WANT to be able to indicate the method used to verify an applicant’s identity 

So that I can process the application

*Context*

Once all relevant checks has been made i.e. all supporting documents has been review and satisfied as adequate identity evidence

Then EROs can confirm the method that they used to verify the applicant’s identity 



*Notes*

* Selecting a method used to verify identity is optional 
* API ticket 

[https://technologyprogramme.atlassian.net/browse/EIP1-7198|https://technologyprogramme.atlassian.net/browse/EIP1-7198|smart-link] 



*Screen designs* 



!image-20230504-162839.png|width=83.33%!



!image-20230504-163219.png|width=83.33%!



AC1 

GIVEN an authorised user is in the identity tab 

WHEN an applicant’s identity has been assessed 

THEN the user can select the method they used to verify the applicants identity 



AC2 

GIVEN an authorised user is in the identity tab 

WHEN they select a method used to assess identity 

AND they have accepted or rejected the users identity 

THEN the UI should show the assessment option selected in the ‘option selected’ field 

AND the UI should show any additional notes in the ‘notes’ field 



AC3 

GIVEN an authorised user is in the identity tab 

WHEN they select a method used to assess identity 

AND they have accepted or rejected the users identity 

AND has not selected an assessment option 

THEN the ‘option selected’ field should show ‘not provided’ 



AC3 

GIVEN an authorised user is in the identity tab 

WHEN they select a method used to assess identity 

AND they have accepted or rejected the users identity 

AND they have not provided any additional notes 

THEN the ‘notes’ field should not show on the page ",To Do,,yusuf.eldin,,31/Mar/23 3:44 PM,12/Sep/23 3:52 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-5244,Three,,Story,"As an ERO administrator reviewing an application 

I want the ability to undo determinations made on added or uploaded documents 

So that I can correct mistakes 

h3. *Notes* 

API ticket :

[https://technologyprogramme.atlassian.net/browse/EIP1-7197|https://technologyprogramme.atlassian.net/browse/EIP1-7197|smart-link] 

h3. *Screen design*

!image-20230912-030608.png|width=997,height=920!

h3. *Acceptance criteria*  

h3. *AC*1

Given an ERO has accepted or rejected a document for review 

When they press the undo button 

THEN the determination on that documents should be removed  [https://technologyprogramme.atlassian.net/browse/EIP1-7197|https://technologyprogramme.atlassian.net/browse/EIP1-7197|smart-link] 

AND the document should be moved to the 'documents for review section",To Do,,yusuf.eldin,,31/Mar/23 4:24 PM,12/Sep/23 4:08 AM,,,,EIP1-4308,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-5257,Three,,Story,"As ERO making final determination on OE applications

I WANT to ensure that approvals and rejections is sent to EMS via IER

h2. *Notes*:

This ticket is one part of the process to sending the approvals and rejections to the EMS. This will need to be done via IER which ticket will cover

h2. Tech Notes:

The following is the proposed contract for EROP to send to IER

[https://github.com/cabinetoffice/ierds/blob/eip-master/middle-tier/erop-api/src/erop-api-spec/Models/DeterminedRtvOverseasApplicationMessage.yaml|https://github.com/cabinetoffice/ierds/blob/eip-master/middle-tier/erop-api/src/erop-api-spec/Models/DeterminedRtvOverseasApplicationMessage.yaml] 

h2. *Acceptance Criteria*

GIVEN the ERO has made final determination

WHEN the ERO has selected the Approve Overseas Application or Reject Overseas Application button

THEN the final determination will be sent by SQS to IER",To Do,,Krister Bone,,01/Apr/23 1:59 PM,11/Sep/23 2:14 PM,,,,EIP1-7302,,3.0,,,,API|Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-5272,Three,,Story,"As an ERO administrator 

I want to edit an electors details 

so that i can update applications correctly 

----

h2. Notes 

This ticket covers page 2 of the Overseas Elector manual creation screens. which can be edited from the application details tab 

[https://technologyprogramme.atlassian.net/browse/EIP1-7440|https://technologyprogramme.atlassian.net/browse/EIP1-7440|smart-link] 



----

h2. Acceptance Criteria

h3. Scenario 1 - Edit Option

*Given* an OE  Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* First Name
* Middles Names
* Last Name
* Current address outside of the UK 
* Correspondence address 

h3. Scenario 2 - Edit Initiated

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*And* I click the ‘Change’ option for one of the data points outlined in Scenario 1 
*Then* I am displayed the Edit view for Edit Elector Details [https://technologyprogramme.atlassian.net/browse/EIP1-7440|https://technologyprogramme.atlassian.net/browse/EIP1-7440|smart-link] 
*And* I can manually edit the details 

h3. Scenario 3 - Editing Elector Name

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the elector name (first, middle & last names)
*And* validation rules from the creation are inherited

h3. Scenario 4 - Current address outside of the UK 

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the elector’s Current address outside of the UK 
*And* validation rules from the creation are inherited

h3. Scenario 5 - Correspondence address 

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the elector’s Correspondence address 
*And* validation rules from the creation are inherited

h3. Scenario 6 - Edit Contact Details

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the elector’s contact details (Phone number & Email)
*And* validation rules from the creation are inherited

h3. Scenario 7 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved

h3. Scenario 8 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab

h3. Scenario 9 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,01/Apr/23 3:51 PM,11/Sep/23 10:34 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-5273,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to reject documents added as seen in support of the applications for under 18 leavers 

So that I can process this application



*Context*

This ticket will cover sending communications to request new documents after documents have been rejected. 

This action can be performed on both uploaded documents and offline documents. 

This pattern currently applies to all qualifying address sections where document uploads are provided 

* Proof of parent/guardian relationship 
* Documentary evidence 
* Attestation 



*Notes*

* {color:#ff5630}Confirmation needed on whether specific comms templates will be required based on which section the request for new documents was initiated, e.g. documentary evidence vs attestation or of this can be generic. {color}



*Screen Design*

!image-20230816-202348.png|width=75%!



h3. Acceptance Criteria

*AC1: Send rejection communication* 

GIVEN the the authorised user has rejected a document under review

AND wishes to send comms to the applicant by selected comms method i.e. either by Govt notify email or letter 

AND has entered a message i.e. request new document etc

WHEN the user selects the Send communication button

THEN the message will be sent via the selected communication method

AND a banner with sent confirmation, name and date and time will display

AND the ‘Send communication’ button will change to ‘Send another communication’ 

AND when sending repeat notifications the time and date in the banner should change to last sent time 

AND ‘send another communication’ button should persist when the user navigates from and returns to the page  



*AC2: No email provided* 

GIVEN the the authorised user has rejected a document under review

AND wishes to send comms to the applicant 

AND the applicant has not supplied an email address 

WHEN the user navigates to the rejected document section 

THEN the radio buttons to select a communication method are not shown 

AND the message method will default to letter



*AC3 Message options* 

GIVEN the the authorised user has rejected a document under review

AND the applicant has provided an email address and correspondence address 

WHEN they select the communication method 

THEN the text ‘Send communication via….’ should change to correspond to the selected communication method  



*AC4: Preview communication* 

GIVEN the the authorised user has rejected a document under review

WHEN they click the ‘preview communication’ link 

THEN a message preview should open in a new tab 

AND The preview should show the names of the rejected documents 

AND the preview should show the selected rejection reasons for each document

AND the preview should show optional messages sent to the applicant ",To Do,,yusuf.eldin,,01/Apr/23 4:28 PM,08/Sep/23 2:39 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|Squad_Andromeda|Valtech,,,,
EIP1-5274,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm an electors parent or guardian status for qualifying address information
*So that* I can approve / reject residency for an overseas application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have confirmed an electors parent / guardian’s relationship.
This is a sub determination as part of an under 18 qualifying address check.

To approve an under 18 parent guardian status, the following 2 sub-sub determinations needs to be satisfied:

# A document type of birth certificate needs to be added?
# One of the following additional sub determinations need to have been made
## Parent Guardian as matched from the birth certificate is found on the register
## Documentary evidence
## Local Data Match evidence
## Attestation evidence.

h2. {color:#ff5630}Under 18 - Questions:{color}

# Does the applicaiton always need a birth certificate?
# If Yes, how does the parent or guardian details get entered? This a manual copy from birth certificate.
# If no, how do you validate the parent guardian? Are there other document types, or can it be the fall backs:
## documetary evidence
## local data match
## attestation
# If no and use other fall backs - how do you manage local elector and parent guardian checks?

h2. Acceptance Criteria

h3. AC1: Approve Parent Guardian Status - (201 Happy Path)

*Given* an ERO wants to indicate they have approved an elector's parent guardian status
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*And* the application has an approved birth certificate (discuss meta data / documents)
*And* one of the following parent sub determinations has been approved - register, documentary, local data match or attestation 
*When* they call the set parent guardian status API to set the status to approved
*Then* the API will return a 201 response to indicate the status has been set to approved
*And* the parent guardian approved status will be returned as part of the qualifying address from the Get Application By Id

h3. AC2: Approve Parent Guardian Status - No Approved Birth Certificate - (409 Un-Happy Path)

*Given* an ERO wants to indicate they have approved an elector's parent guardian status
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*And* the application doesn’t have an approved birth certificate (discuss meta data / documents)
*When* they call the set parent guardian status API to set the status to approved
*Then* the API will return a 409 response to indicate the status has *NOT* been set to approved

h3. AC3: Approve Parent Guardian Status - No Approved Birth Certificate - (409 Un-Happy Path)

*Given* an ERO wants to indicate they have approved an elector's parent guardian status
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*And* none of the following parent sub determinations has been approved - register, documentary, local data match or attestation 
*When* they call the set parent guardian status API to set the status to approved
*Then* the API will return a 409 response to indicate the status has *NOT* been set to approved


h2. Error Scenarios

h3. AC4: Application’s Qual Address verification is Determined - (409)

h3. AC5: The application has been Determined (409)

h3. *AC6:* (i) (Plus the usual 401/403/404 etc)",To Do,,yusuf.eldin,,01/Apr/23 4:30 PM,08/Sep/23 2:44 PM,,,,EIP1-5175,,,,,,API|Beta|OE|RefineInProgress|Valtech,,,,
EIP1-5275,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to undo determinations made on documents added in support of the applications for under 18 leavers 

So that I can correct mistakes I have made, or update a determination based on new information. 



*Context*

When an applicant is under 18 years old and is applying under the previous registration of a parent/guardian the ERO will see the following screen, and can undo actions (accept/ reject) made on the documents)

This ticket will cover undo for uploaded and offline documents 



*Notes* 

{color:#ff5630}Undo document rejection API ticket required{color}



*Screen Design*

!image-20230904-235558.png|width=662,height=619!



h2. Acceptance Criteria

h3. Undo rejected document



*AC3: Undo rejected document*

GIVEN an ERO has rejected a document in the document for review section

WHEN the document displays in the rejected documents section

THEN the rejected document will show an undo accept reject button

*AC4: Undo rejected document*

GIVEN a document is in the rejected documents section

WHEN the ERO clicks the undo reject document button

THEN the document status should be updated[https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] to remove rejection

AND the document will move back into the documents for review section",To Do,,yusuf.eldin,,01/Apr/23 4:42 PM,08/Sep/23 2:43 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-5276,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my determination on an 18 leaver’s parent, guardian evidence  

so that I can process the application 

*Context*

Once all relevant checks has been made i.e. all supporting documents has been reviewed and an ERO has confirmed whether it is sufficient or not to confirm or not the validity of the relationship 

*Assumptions*

* Supporting documents has been provided in support of the application and/or
* Additional documentation has been provided and uploaded

*Screen Design*

!image-20230816-224612.png|width=100%!

!image-20230816-224639.png|width=100%!



h3. Acceptance Criteria

*AC1: accept relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their parent/ guardian relationship 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time of confirmation will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-5274|https://technologyprogramme.atlassian.net/browse/EIP1-5274|smart-link] 



*AC2: reject relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their parent/ guardian relationship 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time of confirmation will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-5274|https://technologyprogramme.atlassian.net/browse/EIP1-5274|smart-link] {color:#ff5630} {color}",To Do,,yusuf.eldin,,01/Apr/23 4:45 PM,08/Sep/23 2:44 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-5277,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to reject documents added as seen in support of the applications for under 18 leavers 

So that I can process this application



*Context*

When an applicant is under 18 years old and is applying under the previous registration of a parent/guardian the ERO will see the following screen, and can check the applicant’s evidence related relationship to parent/guardian

This ticket will cover rejecting uploaded documents, and documents added as seen.

This screen will follow the same rejection pattern used for postal and proxy identity document rejection 



*Notes*

* Providing a rejection reason for a document is optional however, when ‘other’ is selected comment is mandatory 



*Screen Design* 

!image-20230830-124446.png|width=100%!

*Rejection reasons list when rejecting a document* 

!image-20230830-125111.png|width=619,height=609!



h3. Acceptance Criteria

*AC1: Reject uploaded document reason*

GIVEN that the authorised user is in the Qualifying address tab

AND is reviewing uploaded documents in the ‘Documents for review’ section

WHEN the user clicks the ‘Reject document’ button

THEN the UI will show the reject document reasons

AND a text box to add additional explanation for rejection

AND a ‘reject document' and 'cancel’ button

 

*AC2: Reject CTA*

GIVEN that the authorised user is rejecting a document under review

AND selects rejection reasons

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection and a link to the document

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 

 

*AC2 a): Reject with no reason selected*

GIVEN that the authorised user is rejecting a document under review

AND does not select a rejection reason

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ERO name and date and time of rejection

AND *rejected reason* will show *‘not provided’*

AND the ‘Undo reject document’ button will be displayed

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 

 

*AC2 b): Reject CTA with additional information*

GIVEN that the authorised user is rejecting a document under review

*AND* adds additional information

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection

AND an extra field ‘additional information’ will show below.

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 



*AC2 c): Reject CTA with rejection reason ‘other' selected*

GIVEN that the authorised user is rejecting a document under review

WHEN the user selects rejection reasons 

AND the rejection reason selected is 'other'

THEN the additional information field becomes mandatory ",To Do,,yusuf.eldin,,01/Apr/23 6:02 PM,07/Sep/23 12:12 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-5278,Three,,Story,"As an authorised user reviewing applications 

I WANT to be able to view uploaded documents 

So that I can process the evidence provided in support of submitted applications 

*Context*

When documents are uploaded as part of the application process by an applicant, or by an ERO during the review of an application. This ticket will cover the ability to view the documents that have been submitted as part of the application assessment. 

*Designs*

!image-20230830-142408.png|width=735,height=1192!



AC1: Review Document

GIVEN that the user has navigated to an uploaded document in the document for review or the accepted/ rejected section 

WHEN the user has clicked on the Review  Document button or the document link 

THEN a document viewer will load the document in read-only mode",To Do,,yusuf.eldin,,01/Apr/23 6:04 PM,06/Sep/23 4:29 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-5279,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run register checks against a parent/ guardian’s details

So that I can determine if an under 18 leaver is eligible to vote based on their parent/guardian’s previous registration status  



*Notes* 

policy decision still required on the actions that are available in relation to an exact match. e.g. should the register checker run and automatically determine the section based on the result from the register check. e.g. if the register checker returns an exact match should the section be automatically confirmed or still confirmed manually by an ERO 

UX question to understand if the ‘check register’ button should be removed if the register checker result has been returned and no details have been updated 



*Screen Designs*



!image-20230816-230901.png|width=100%!



Step2: Select rejection reason and additional explanation

h2. Acceptance Criteria

*AC1: Run register check*

GIVEN that the authorised user is in the qualifying address tab 

And wishes to run a register check on an under 18 leaver’s application 

When they click the check register button 

Then the register checker will run against the parent/ guardian’s details (see. [https://technologyprogramme.atlassian.net/browse/EIP1-7332|https://technologyprogramme.atlassian.net/browse/EIP1-7332|smart-link] )

and the date and time of the register check will be updated 



*AC2: Single Exact Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a Single match with the elector details in the EMS

WHEN the results from the automated checks returns the exact match

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND a text result from the register check will display ie Matches found on the register(1)

AND the EXACT MATCH text label with Green background with display

AND a Confirm Elector Register Check button

(See designs above)

 

*AC3: Single Partial Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a Single Partial match with the elector details in the EMS

WHEN the results from the automated checks returns the partial match

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND the differences will be highlighted in Yellow

AND a text result from the register check will display ie Partial Matches found on the register(1)

AND the PARTIAL MATCH text label with Dark Blue background with display

AND a Confirm Elector Register Check button

 

*AC4: Multiple Partial Matches*

GIVEN the authorised user is the qualifying address tab 

AND there is a multiple Partial matches with the elector details in the EMS

WHEN the results from the automated checks returns the matches

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND repeated one above the other for the number of matches

AND the differences will be highlighted in Yellow

AND a text result from the register check will display ie Partial Matches found on the register(>1)

AND the PARTIAL MATCH text label with Dark Blue background with display above each match

AND a Confirm Elector Register Check button under each match

 

 *AC5: No Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a no match with the elector details in the EMS

WHEN the results from the automated checks returns the no match outcome

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND a text result from the register check will display ie No matches found

AND the NO MATCH text label with Dark Blue background with be displayed

 

*AC6: Pending* 

GIVEN the authorised user is the qualifying address tab 

AND the automated checks had yet to return a result

WHEN the user views the register checker results 

THEN the user will see a Pending autocheck results text message 

 

*AC7: Awaiting response from EMS*

GIVEN the authorised user is the qualifying address tab 

AND response from the EMS for the autocheck is yet to be received

THEN the user will see an Awaiting Response from EMS text label

AND the applicant details one the left

AND a blank EMS data panel on the right",To Do,,yusuf.eldin,,01/Apr/23 6:06 PM,11/Sep/23 10:33 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-5280,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record documents that has been uploaded and accepted in support of an application for under 18 leavers

So that I can process this application



*Context*

When an applicant is under 18 years old and is applying under the previous registration of a parent/guardian the ERO will see the following screen, and can check the applicant’s evidence related to their UK residence.

Thiis ticket will cover uploading documents as well as adding offline documents. 



*Notes*

* {color:#ff5630}Confirmation needed on acceptable documents list {color}



*Screen designs*

!image-20230905-181031.png|width=752,height=1104!



h2. *Acceptance Criteria*

*Upload Document*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Qualifying address tab

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

*AC2:*

Given an authorised user is in the Qualifying address tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Choose file’ CTA

THEN the upload file facility will allow a user to upload a document [https://technologyprogramme.atlassian.net/browse/EIP1-7300|https://technologyprogramme.atlassian.net/browse/EIP1-7300|smart-link] 

AND ‘No File chosen’ should be replaced by the uploaded file name

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Qualifying address tab

WHEN the user has uploaded a supporting document

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review and Reject buttons and a link to the document

*AC4:*

Given an authorised user is in the Qualifying address tab

WHEN the user has uploaded a supporting document

THEN the document should show in a ‘loading state’ in the documents for review tab, until the upload is confirmed



*Add document as seen*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Qualifying address tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

 *AC2:*

Given an authorised user is in the Qualifying address tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Add document’ CTA

THEN the user will see the document in the ‘Documents for review’ section [https://technologyprogramme.atlassian.net/browse/EIP1-7309|https://technologyprogramme.atlassian.net/browse/EIP1-7309|smart-link]  

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Qualifying address tab

WHEN the user has added a document as seen

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review and ‘Reject document as seen’ buttons",To Do,,yusuf.eldin,,01/Apr/23 6:09 PM,08/Sep/23 2:43 PM,,,,EIP1-5175,,,,,,Beta|OE|RefineInProgress|UI|Valtech,,,,
EIP1-5289,Three,,Story,this ticket will cover the re-run of register checks when an applicant’s details are edited,To Do,,Krister Bone,,01/Apr/23 6:41 PM,12/Sep/23 1:04 AM,,,,EIP1-4886,,,,,,API|Beta|NotRefined|OE|Valtech,,,,
EIP1-5291,Three,,Story,"*As an* ERO
*I want* to create new overseas applications in the EROP 
*So that*  I can store and process those received on paper or in person

h3. Tech Notes:

* SW App Ref Code Generator: [SW App Ref generation|https://github.com/cabinetoffice/ierds/blob/eip-master/frontend/src/session/session.ts#L193]
* {color:#ff5630}There are clear differences between the IER to EROP contract and the EROP Create Application{color}

----

*Create new application (this data needs refined based on designs)*

* Data:
** Enter elector details
*** gsscode
*** National Insurance number (optional)
*** Channel - Paper / In-Person
*** Last Registered Category - ordinary, overseas, forces, crown, council, not-sure
*** Last Registred Date
*** Include In Open Register
*** Language - English / Welsh
*** First name, MiddleNames (optional), Lastname
*** Previous First name, MiddleNames (optional), Lastname
*** Name Change reason
*** Has Birtish Passport / Passport Number / Issue Date
*** Address (optional fields except for street and postcode)
*** Date of Birth (optional)
*** British Citizen Date / How Became Citizen
*** Birth Place
*** Phone Number (optional)
*** Email address (optional)
*** previous registered address
*** correspondence address
*** Parent Guardians - Names, Previous Names
*** dateTimeReceived {{The date and time that the application was received.example: '2022-09-28T18:01:42.105Z'}}
*** IP address will be captured in the API using headers that identify the source ip
* Submit application
** API validation 
*** DOB not in future
*** Date became citizen in the past
** successful submit
*** generate application reference number
**** use same process as Softwire -  overseas application references will be returned starting with the character 'O'?
*** Generate application ID GUID
*** Location header returned pointing to newly created application

h2. Acceptance Criteria

h3. AC1:  Create Application - 201 Happy Path

*Given* an *authorised user* in the *overseas-admin* group for the *current ERO*
*When* I try to call the *REST API  POST endpoint* to create a overseas application manually
And the application has all the required fields populated and meets the OpenAPI contract
*Then* the application is created and the applicationID and applicationReference (will start with 'O') are returned in the response
*And* a 201 response code is returned along with location header pointing to new application that was created

h3. *AC2:* Create Application - 400 Un-Happy Path

*Given* an *authorised user* in the *overseas-admin* group for the *current ERO*
*When* I try to call the *REST API  POST endpoint* to create a postal application manually
*And* there is a validation error

* DOB must not be in future
* A.O.Rules

*Then* 400 response code is returned

h3. *AC3:* Create Application - Register Auto Check

*Given* an application is successfully created
*When* the application needs a register check performed
*Then* a register check will be automatically queued

h3. *AC4:* Create Application - Residency Auto Check

*Given* an application is successfully created
*When* the application needs a residency check performed
*Then* a DWP address check will be automatically queued (no nino)


h3. *AC5:* Create Application - Identity Auto Check

*Given* an application is successfully created
*When* the application has a nino
*Then* a DWP identity check will be automatically queued (with NINO)

h3. *AC6:* (i) (Plus the usual 401/403 etc)

{panel:bgColor=#deebff}
*Out of scope:*

* Documents will not be part of POST / Create
{panel}",To Do,,Krister Bone,,02/Apr/23 12:49 PM,11/Sep/23 3:05 PM,,,,EIP1-5177,,,,,,API|Beta|OE|RefineInProgress|Valtech,,,,
EIP1-5293,Three,,Story,"*As an* Elector
*I want* to receive an email notification to inform me that my paper application has been received 
*So that* I have a reference number I can use in future communications and can be sure my application has been submitted.

*Assumptions:*

* Notifications will only be sent where for applications where an email address has been provided
* This story extends [https://technologyprogramme.atlassian.net/browse/EIP1-3891|https://technologyprogramme.atlassian.net/browse/EIP1-3891|smart-link]

*Technical Notes:*

# Extension to the service: [https://github.com/cabinetoffice/eip-ero-notifications-api|https://github.com/cabinetoffice/eip-ero-notifications-api|smart-link]
# On receiving and storing a new application - raise an SQS event for the Notification API to receive.
# The Notification API service will need a new {{MessageType}} added to support Postal received message types and EN/CY email versions.
# Add a new GOV.Notify message template and configure Notification API deployment with MessageType / Message Template GUID. 
# See [https://confluence.valtech.com/display/DLVC/EIP1-2955+UK+Government+Notify+Behaviour|https://confluence.valtech.com/display/DLVC/EIP1-2955+UK+Government+Notify+Behaviour]

*AC1:*

*Given* a new application is submitted in English
*When* the application is saved to the database
*Then* a email will be sent to the Elector in English

*AC2:*

*Given* a new application is submitted in Welsh
*When* the application is saved to the database
*Then* a email will be sent to the Elector in Welsh",To Do,,Krister Bone,,02/Apr/23 12:53 PM,11/Sep/23 3:51 PM,,,,EIP1-5177,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-5294,Three,,Story,"*As an* ERO Overseas Admin
*I want* applications to be checked against EMS registers
*So that* I can see if the Elector or their Parent / Guardian is/was registered

----

*Technical Notes*

This will create the ability for the overseas service to send SQS messages to the register check service. The message will be queued as part of the save/create/edit process of the application.
When the SQS message is queued, the application will update the status will be set following the same pattern as OAVA.

----

*AC1:*
*Given* a application is received / edited
*When* the application is saved to the database
*And* the application needs to check either the elector’s or electors parent / guardian register status
*Then* it will be saved with a register status of PENDING
*And* will send a SQS message to the Register Checker service (with either the elector or the elector’s parent / guardian details)",To Do,,Krister Bone,,02/Apr/23 12:54 PM,11/Sep/23 3:52 PM,,,,EIP1-5177,,3.0,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-5295,Three,,Story,"*As an* ERO Overseas Admin
*I want* applications to be checked against DWP services
*So that* I can see if the Elector’s NINo matches
*And* that I can see if the Elector’s or their Parent / Guardian's historical address matches

----

*Technical Notes*

This will create the ability for the overseas service to send SQS messages to the DWP service. The messages will be queued as part of the save/create/edit process of the application.
When the SQS message is queued, the application will update the statuses following the same pattern as OAVA.
There can be up to 2 DWP checks on each application:

# Elector’s Identity Check - with NINo
# Elector, or their Guardian’s Address Check - without NINo

Each with it’s own status.

----

*AC1:*
*Given* a application is received / edited
*And* the elector has provided a NINo
*When* the application is saved to the database
*Then* it will create an EROP DWP Request SQS message
*And* the application will be saved with a identity status as pending

*AC2:*
*Given* a application is received / edited
*And* the elector has provided historical address details (their’s or their parent / guardian)
*When* the application is saved to the database
*Then* it will create an EROP DWP Request SQS message
*And* the application will be saved with a qualifying address status as pending
",To Do,,Krister Bone,,02/Apr/23 12:56 PM,12/Sep/23 12:57 AM,,,,EIP1-5177,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-5296,Three,,Story,"*As an* Elector
*I want* to receive an email notification to inform me that my application has been received with my application reference number
*So that* I have a reference number I can use in future communications and can be sure my application has been submitted.

----

*Technical Notes:*

# {color:#4c9aff}On receiving and storing a new application - raise an SQS event for the Notification API to receive.{color}
# {color:#4c9aff}This is mapping the saving/saved postal application to the SQS notification message{color}

----

*Given* a new application is submitted in English
*When* the application is saved to the database
*Then* a email will be sent to the Elector in English

*AC2:*

*Given* a new application is submitted in Welsh
*When* the application is saved to the database
*Then* a email will be sent to the Elector in Welsh",To Do,,Krister Bone,,02/Apr/23 12:57 PM,11/Sep/23 4:09 PM,,,,EIP1-5177,,5.0,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-5297,Three,,Story,"*As an* ERO Overseas Admin
*I want* applications to be checked against EMS registers
*So that* I can see if the Elector or their Parent Guardian is/was registered

----

*Technical Notes*

This will create the ability for the overseas service to receive SQS messages back from the register check service. 

The register check could be for the elector or the elector’s parent / guardian but should be saved to the same structure regardless.

----

*AC1:*
*Given* the register checker service queues a response for a overseas service register check request
*When* the service retrieves the message
*Then* the status of the applications register status will be updated",To Do,,Krister Bone,,02/Apr/23 12:58 PM,12/Sep/23 12:35 AM,,,,EIP1-5177,,5.0,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-5376,Three,,Story,"As authorised user viewing the application

I WANT to be able to assign the application to another authorised user

SO that they can process the application



*Design*

!image-20230315-100016.png|width=1184,height=344!



*Scenario - assigning an application to an ERO user (themselves) :* 

*a*

Given an authorised user is viewing an application 
When the application is new and not assigned to anyone
Then the assignee will display as ‘Unassigned’
And I can assign it to another ERO user

*b*

Given an authorised user is viewing an application
When the authorised user views the available ERO users with a single select dropdown 
Then authorised user will be presented with a list of ERO users email addresses that have access to the application

*c*

Given an authorised user is viewing the potential assignees 
When the authorised user selects a ERO user email from the potential assignees
Then the application assignee will be updated to the selected ERO users email address",To Do,,Shane.yin,,06/Apr/23 11:10 AM,11/Sep/23 12:56 PM,,,,EIP1-5374,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7121,Three,,Story,"As an ERO 

I want to see the relevant information in the application listing page 

So that I can correctly identify and process applications

----

The listing UI will look similar to postal and proxy with  the qualifying address section being unique to OE

h2. Details

Applications displayed on the listings page should include:

* Applicant’s full name (LAST, First Middle)
* Status
* Registered Address Postcode
* Application Reference Number
* Application Received Date and time 
* Assignee (email address of assigned ero or unassigned)
* Identity Verification status
* Qualifying address status
* Signature status

!image-20230815-093414.png|width=91.66666666666667%!



*Status Table*

||*Status*||*Colour*||*Embedded Text*||
|To Do|Light Green|To Do|
|In Progress|Blue|In Progress|
|Rejected|Red|Rejected|
|Rejection In Progress|Pink|Rejection In Progress|
|Approved|Dark Green|Approved|
|Approval in Progress|Light Purple|Approval in Progress|
|Sent to Print|Pink|Sent to Print|
|On Hold|Orange/Amber|On Hold|



h2. Acceptance Criteria

h3. Scenario 1 - Viewing the listings page

*Given* I am a *authorised user*
*When* I view the Overseas elector application listing
*And* there are more than 25 results to display
*Then* up to 25 results are displayed per page 

h3. Scenario 2 - Default Sort

*Given* I am a *authorised user*
*When* I view the Overseas elector application listing
*Then* results should be sorted by oldest application first 

h3. Scenario 3 - Results Count 

*Given* I am an *authorised user*
*When* I view the overseas electorl application listing
*Then* I should be able to view the total number of results found



*AC4 - System Error* 

Given an *authorised user*

AND a system failure occurs

WHEN I call the *Search REST API* 

*THEN* I will  receive a 400 error and there will be an error message informing the user of error and error will be logged",To Do,,yusuf.eldin,,14/Aug/23 2:59 PM,06/Sep/23 4:05 PM,,,,EIP1-3385,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7145,Three,,Story,"*As a* OE Admin
*In order to* ensure the DOB details are correct
*I want to* be able to edit the DOB details data

----

h2. Context

When processing proxy applications, administrators may need to edit the *Date of Birth* to ensure the data is accurate. 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for Date of Birth

h3. Scenario 2 - Edit Initiated  

*Given* a OE Application
*When* viewing the application details tab 
*And* I click the ‘Change’ option for Date of Birth 
*Then* I am displayed the Edit view for Date of Birth 
*And* below edit sections are displayed:

* Date of Birth

h3. Scenario 3 - Date of Birth

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the Date of Birth
*And* validation rules from the creation are inherited 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 10:04 AM,11/Sep/23 10:34 PM,,,,EIP1-4886,,,,,,Beta|OE,,,,
EIP1-7148,Three,,Story,"*As a* OE Admin
*In order to* ensure the British citizenship details are correct
*I want to* be able to edit the British citizenship details data

----

h2. Context

When processing proxy applications, administrators may need to edit the *British Citizenship details* to ensure the data is accurate. 

Based on page 11 of the manual creation route 

[https://technologyprogramme.atlassian.net/browse/EIP1-7451|https://technologyprogramme.atlassian.net/browse/EIP1-7451|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Citizenship details, British passport holder 

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section

*AND* has selected that they hold a british passport  
*Then* the ‘Change’ option should display for:

* Citizenship statement
* Passport number 
* Place of issue 
* Date of issue 

h3. Scenario 2 - Edit Citizenship details, does not hold a British passport  

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section

*AND* has selected that they do not hold a British passport  
*Then* the ‘Change’ option should display for:

* Citizenship statement
* Date became a British Citizen 
* Reason became a British citizen 
* Place of Birth 
* Country of Birth 

h3. Scenario 3 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ for any application data point from scenario 1 or 2 
*Then* I am displayed the page to edit this information [https://technologyprogramme.atlassian.net/browse/EIP1-7451|https://technologyprogramme.atlassian.net/browse/EIP1-7451|smart-link] 

And I can manually update the application details 


h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 10:14 AM,12/Sep/23 12:28 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7150,Three,,Story,"*As a* OE Admin
*In order to* ensure the last registered address details are correct
*I want to* be able to edit the qualifying address details data

----

h2. Context

When processing proxy applications, administrators may need to edit a parent/ guardian’s details to ensure that they are correct. 

This ticket will cover editing parent/ guarian details from the qualifying address tab, edits from the elector details tab will be covered in another ticket. 

Parent guardian details are editable from the register checker page within the qualifying address tab 

This relates to the following manual creation screens 

[https://technologyprogramme.atlassian.net/browse/EIP1-7445|https://technologyprogramme.atlassian.net/browse/EIP1-7445|smart-link] 

[https://technologyprogramme.atlassian.net/browse/EIP1-7447|https://technologyprogramme.atlassian.net/browse/EIP1-7447|smart-link] 

----

h2. Screen designs 

!image-20230911-222500.png|width=789,height=1151!



----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* First name 
* Muddle name 
* last name 
* previous first name 
* previous last name 
* reason for name change 

h3. Scenario 2 - Edit Initiated

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*And* I click the ‘Change’ option for the following data points 

* First name 
* Muddle name 
* last name 

*Then* I am displayed the Edit view for parent/guardian’s Details [https://technologyprogramme.atlassian.net/browse/EIP1-7445|https://technologyprogramme.atlassian.net/browse/EIP1-7445|smart-link]
*And* I can manually edit the details 

h3. Scenario 3 - Edit Initiated

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*And* I click the ‘Change’ option for the following data points 

* previous first name 
* previous last name 
* reason for name change 

*Then* I am displayed the Edit view for parent/guardian’s Details [https://technologyprogramme.atlassian.net/browse/EIP1-7447|https://technologyprogramme.atlassian.net/browse/EIP1-7447|smart-link] 
*And* I can manually edit the details 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 10:24 AM,11/Sep/23 11:37 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7151,Three,,Story,"*As a* OE Admin
*In order to* ensure the DOB details are correct
*I want to* be able to edit an applicants date of birth data 

----

h2. Context

When processing proxy applications, administrators may need to edit the *DOB* to ensure the data is accurate. 

This ticket relates to [https://technologyprogramme.atlassian.net/browse/EIP1-7443|https://technologyprogramme.atlassian.net/browse/EIP1-7443|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* Date of birth 

h3. Scenario 2 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ option for date of birth 
*Then* I am displayed the Edit view for date of birth [https://technologyprogramme.atlassian.net/browse/EIP1-7443|https://technologyprogramme.atlassian.net/browse/EIP1-7443|smart-link] 
*And* below edit sections are displayed:

date of birth 

h3. Scenario 3 - Date of Birth

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the Date of Birth
*And* validation rules from the creation are inherited 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 10:26 AM,11/Sep/23 10:35 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7152,Three,,Story,"*As a* OE Admin
*In order to* ensure the contact details are correct
*I want to* be able to edit the British citizenship details data

----

h2. Context

When processing proxy applications, administrators may need to edit the *contact details* to ensure the data is accurate. 

----

h2. Notes 

{color:#ff5630}Confirmation of position of contact details within manual creation flow required {color}

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* Contact details 

h3. Scenario 2 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ option for contact details 
*Then* I am displayed the Edit view for contact details 
*And* below edit sections are displayed:

phone number 

email address 

h3. Scenario 3 - phone number 

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the Date of Birth
*And* validation rules from the creation are inherited 

h3. Scenario 4 - email address 

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the email address
*And* validation rules from the creation are inherited 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 10:41 AM,11/Sep/23 10:41 PM,,,,EIP1-4886,,,,,,Beta|OE|RefineInProgress|Valtech,,,,
EIP1-7154,Three,,Story,"*As a* OE Admin
*In order to* ensure the Qualifying address details are correct
*I want to* be able to edit the qualifying address details data

----

h2. Context

When processing proxy applications, administrators may need to edit the qualifying address details to ensure the data is accurate. 



----

h2. Notes 

{color:#ff5630}The following fields which are editable in the application details section for qualifying address are not catered for in the manual case creation wireframes and will require to be added {color}

* {color:#ff5630}UPRN of last known address in the UK {color}
* {color:#ff5630}Previously registered to vote {color}
* {color:#ff5630}Date left the UK {color}

[https://technologyprogramme.atlassian.net/browse/EIP1-7445|https://technologyprogramme.atlassian.net/browse/EIP1-7445|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* Last known/ last registered address in the UK 
* UPRN of last known address in the UK 
* Previously registered to vote 
* Date left the UK 

h3. Scenario 2 - Edit initiated

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ option for any of the data points in scenario 1 
*Then* I am displayed the Edit view [https://technologyprogramme.atlassian.net/browse/EIP1-7445|https://technologyprogramme.atlassian.net/browse/EIP1-7445|smart-link] 
*And* I can manually edit these details 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,15/Aug/23 11:08 AM,11/Sep/23 7:26 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7165,Three,,Story,"Update SQS loader to support search tickets.

This might not need any changes until the IER to EROP contract changes.

Might be worth a check that the data loader is working as expected. ",To Do,,Krister Bone,,16/Aug/23 2:55 PM,06/Sep/23 4:06 PM,,,,EIP1-3385,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7166,Three,,Story,"A review and refresh of the GetById API to align with updated design.

A proposed API structure can be found here:

[https://github.com/cabinetoffice/eip-ero-overseas-applications-api/pull/63|https://github.com/cabinetoffice/eip-ero-overseas-applications-api/pull/63|smart-link] 



OE designs have progressed considerably after development was halted.

Update the OE data model to support the new designs.

The model needs to support both:

# The IER supplied data model:
## EROP: [https://github.com/cabinetoffice/eip-ero-overseas-applications-api/blob/eip-main/src/main/resources/openapi/sqs/overseas-api-sqs-messaging-ier.yaml|https://github.com/cabinetoffice/eip-ero-overseas-applications-api/blob/eip-main/src/main/resources/openapi/sqs/overseas-api-sqs-messaging-ier.yaml]  (CreateOverseasVoteApplicationMessage)
## IER: [https://github.com/cabinetoffice/ierds/blob/eip-master/middle-tier/erop-api/src/erop-api-spec/reference/IER-EROP-APIs.yaml|https://github.com/cabinetoffice/ierds/blob/eip-master/middle-tier/erop-api/src/erop-api-spec/reference/IER-EROP-APIs.yaml]   (CreateRtvOverseasApplicationMessage)
## These should be identical and no changes haev been idenified but expect some to come as the Citizen UI is developed.
# The Manual Case Creation Data Capture: [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=1%3A43&mode=design&t=94004MNkOimmiy46-1|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=1%3A43&mode=design&t=94004MNkOimmiy46-1|smart-link] 

Optional Data:

Manual creation has relaxed field validation and created applications may not contain all data that is requried before sending to EMSs. The new “missingData” field will need to be reviewed and output fields that much be completed before applications can be send to EMSs. Postal and Proxy have implemented this pattern already too.

h2. Technical Notes

The main deviation from OAVA application structure is around:

* Qualifying Address

This is a complex area with multiple routes to “approving” the qualifying address sub-determination.

Note there are 2 route to applying:

# *Residency* - this is where you have never been registered but were eligeble. So you are trying to prove you lived in the UK under X address and were in fact eligible to vote (just didn't reg).
# *Registration* - this is where you are trying to prove you were registered previously in the UK.

The qualifying address can be “approved” via the following routes:

# Prior EMS / Electoral Roll Registration (If registration)
# DWP historical address check (If residency)
# Documentary evidence
# Local data matching
# Attestation 
# Qualifying Address Documents and Notes
# Under 18 (a + 1 other)
## Proof of relationship with parent or legal guardian (birth certificate?)
## Parent or legal guardian previously in EMS / electoral roll (If registration  - auto or manual)
## Parent or legal guardian DWP previous address check (If residency)
## Parent or legal guardian local data matching
## Parent or legal guardian documentary evidence
## Parent or legal guardian attestation

h2. Assumptions

# To determine if an application is a residency or registration application it is based on the value of the field “{{previouslyRegisteredOverseas}}""
# To determine if the applicant is applying as <18 when left the UK, this is derived by calculating age leaving UK → current age - date left uk",To Do,,Krister Bone,,16/Aug/23 2:59 PM,11/Sep/23 4:44 PM,,,,EIP1-3867,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7170,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my progress in actions taken to verify an under 18 leaver’s right to vote 

so that I can process the application 

*Context*

*Screen designs*

!image-20230817-171851.png|width=552,height=997!



h2. *Acceptance Criteria*

*Upload Document*

*AC1: Proof of relationship* 

Given an authorised user is processing an application

WHEN they click the proof of relationship link 

THEN the user should navigate to the proof of relationship with parent/ legal guardian page ( see[https://technologyprogramme.atlassian.net/browse/EIP1-5276|https://technologyprogramme.atlassian.net/browse/EIP1-5276|smart-link] )

AND the proof of relationship status should update based on updates to that page (Incomplete/ confirmed) 



*AC2: Automated register check*

Given an authorised user is processing an application

WHEN they click the automated register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-5279|https://technologyprogramme.atlassian.net/browse/EIP1-5279|smart-link]  )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 



*AC3: Paper register check*

Given an authorised user is processing an application

WHEN they click the paper register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7196|https://technologyprogramme.atlassian.net/browse/EIP1-7196|smart-link]  )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 



*AC4 : local data matching*

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7326|https://technologyprogramme.atlassian.net/browse/EIP1-7326|smart-link] 

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) 



*AC4 : Documentary evidence* 

Given an authorised user is processing an application

WHEN they click the documentary evidence

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7358|https://technologyprogramme.atlassian.net/browse/EIP1-7358|smart-link] 

AND the local data matching should update based on updates to that page (confirmed/ not confirmed)



*AC5 : attestation* 

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( [https://technologyprogramme.atlassian.net/browse/EIP1-7327|https://technologyprogramme.atlassian.net/browse/EIP1-7327|smart-link] 

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) ",To Do,,yusuf.eldin,,16/Aug/23 8:09 PM,08/Sep/23 2:43 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7196,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run register checks against an applicant’s parent’s details 

So that I can determine if an applicant is eligible to vote based on their parent’s previous registration status  

*Background* 

Once an ERO has checked the paper voter registration records they can manually verify within the paper registration record tab. 

This ticket related to the verification of a parent/carer’s previous registration. 



*Screen Designs*

!image-20230817-171420.png|width=100%!

!image-20230817-171642.png|width=527,height=691!



h3. Acceptance Criteria

*AC1: Confirm paper registration check* 

Given an authorised user is in the qualifying address tab 

WHEN they visit the paper register checks section 

THEN the UI should display the details provided in the application (see screen design)



*AC2: Confirm paper registration check* 

Given that the authorised user is in qualifying address tab 

AND has confirmed that the paper electoral register matches the details provided in the application 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time of confirmation will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] 



*AC3: reject paper registration check* 

Given that the authorised user is in qualifying address tab 

AND has not found a match between the paper electoral register and  the details provided in the application 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with rejection message, ERO email and date and time of rejection will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] ",To Do,,yusuf.eldin,,17/Aug/23 6:05 PM,11/Sep/23 10:33 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7197,Three,,Story,"*As a* overseas-admin having made an error approving or rejecting a document
*I want* to undo approved and rejected document statuses
*So that* I can correct my mistake.

----

*Context*

* Extension to PATCH {{/eros/{eroId}/applications/{applicationId}/documents/{documentId}}} to allow setting status back to not-checked
* This is an omission to the original story 4814 so the same determination rules apply

----

*Acceptance Criteria*

h3. AC1: Set Signature Status - not-checked

*Given* an *authorised user*
*And* an {applicationId} of a overseas application
*And* a {documentId} of a document
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database

{color:#ff5630}AND DETERMINATION RULES{color}
*And* a document with the {documentId} is associated to the overseas application
*When* I call the *Set Document Status API* to {{not-checked}}
*Then* the document status will be set to {{not-checked}}",To Do,,Krister Bone,,18/Aug/23 11:22 AM,11/Sep/23 11:53 AM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7198,Three,,Story,"*As an* ERO reviewing an electors exception identity information
*I want* to be able to indicate that I have verified or rejected the applicants identity based on the information provided
*So that* I can process the application to determination. 

*Context*

API story to support the implementation of [https://technologyprogramme.atlassian.net/browse/EIP1-5231|https://technologyprogramme.atlassian.net/browse/EIP1-5231|smart-link] 



h2. Technical Notes

Update to APIs: 

# PUT '/eros/{eroId}/applications/{applicationId}/identity-check'
# GET '/eros/{eroId}/applications/{applicationId}'

1 above needs extended with:

# Identity Check Type - enum - nino (not available via API), documentary evidence, local data matching, attestation.
# Notes (500 characters) 

h2. Acceptance Criteria

h3. S1: Set Identity Check Type and Notes - (201 Happy Path)

*Given an* ERO has reviewed an electors attestation / local data match information
*When* they accept or reject the information 
*Then* they can update the application’s identify check status to reflect the decision
*And* they can add notes to describe their reason

h3. S4: Application’s Identity Check is Determined - (409)

h3. S5: The application has been Determined (409)

h3. *S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,18/Aug/23 11:40 AM,11/Sep/23 11:48 PM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7202,Three,,Story,"*As a* ERO viewing a document provided by the elector
*I want* to indicate why a document has been rejected and add notes where required
*So that* the reasons and notes can be used for reporting and used for communicating with electors


----

*Notes*

* Update Document Status API to to allow multiple rejection reasons when rejecting a document
* Add rejection reason notes to API
* Change rejection reason {{document-illegible}} to be {{applicant-details-not-clear}} instead

----

h2. Acceptance Criteria

h3. S1: Set Document Status and Notes - (201 Happy Path)

*Given* an ERO has reviewed an identify document on an overseas application
*When* they accept or reject the document
*Then* they can update the application’s document status to reflect the decision
*And* they can add notes to describe their reason

{color:#ff5630}ADD rejected rules{color}

h3. S2: Application’s Identity Check is Determined - (409)

h3. S3: The application has been Determined (409)

h3. *S4:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,18/Aug/23 2:18 PM,11/Sep/23 11:56 AM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7204,Three,,Bug,"This is copied from 7028 previously in Postal so OE is assumed to have the same shortcoming. See commit e9159d34d3a7b1b5937db0eae39bc27809a68a43 in postal for fix.

Currently, when an identity verification status PUT request is sent with a status of ‘rejected’, this is saved in the backend as ‘pending-check’ and ‘awaiting-response’ is returned form the API in a subsequent get application by ID GET request.

This needs to be updated so that the identity verification status of ‘rejected’ can be saved and returned in relevant GET requests.",To Do,,Krister Bone,,18/Aug/23 2:25 PM,11/Sep/23 11:35 PM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7205,Three,,Story,"This is copied from 7032 - OE doesn’t support “identity check type” yet. Once #7198 is done, the DWP check needs to update the type.

When a nino identity check comes back with an auto match, the identity verification type needs to be set as ‘nino’",To Do,,Krister Bone,,18/Aug/23 2:27 PM,11/Sep/23 11:50 PM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7206,Three,,Story,"*As a* overseas-admin processing an application
*I want* to upload documentation evidence provided by the elector
*So that* I can associate documents to the application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to upload a new document, so that it is displayed within the list of documents within the application.

h2. Extension 

Proposing the use of META data tags to give greater context to the documents within the application. This is to support much of the complexity around the QA process.

h2. Requirements

* A document will be added to an application’s list of documents. It will not replace any existing documents.
* It will not be possible to upload a document if the application has been approved/rejected, or if the identity verification is determined (e.g. by NINO).
* Once uploaded and moved to the target S3 bucket, the document’s status will be {{RECEIVED}}
* The overseas-admin will then need to approve/reject the document accordingly.
* We will not attempt to validate the document (other than it’s a document type - see below) . It will be the responsibility of the {{overseas-admin}} to ensure the document is appropriate. Backend will merely return a {{pre-signed S3 URL}}, which will then enable the UI to upload directly to S3 within a configured timeframe (2 to 5 minutes).
* Supported types: {{PNG}}, {{GIF}}, {{JPG}} or {{PDF}} formats - {color:#ff5630}See {color}[{color:#ff5630}https://github.com/cabinetoffice/eip-ero-voter-card-applications-api/blob/63364b22527485cd4c2277e46f3977f06242189a/src/main/resources/openapi/VoterCardApplicationAPIs.yaml#L4704{color}|https://github.com/cabinetoffice/eip-ero-voter-card-applications-api/blob/63364b22527485cd4c2277e46f3977f06242189a/src/main/resources/openapi/VoterCardApplicationAPIs.yaml#L4704]
* As part of the AWS {{GeneratePresignedUrlRequest}} -  add Meta Data as part of the {{GeneratePresignedUrlRequest}} which will then be read as part of the {{S3EventNotificationMessage}} namely:
** filename
** gss code
** application id
** document type
** proposed document id
** tags
* More info - this has been implemented for OAVA
** See [https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMetadata.html|https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMetadata.html|smart-link] 
** [https://stackoverflow.com/questions/37614286/aws-s3-add-set-update-specify-user-metadata-with-a-presigned-url|https://stackoverflow.com/questions/37614286/aws-s3-add-set-update-specify-user-metadata-with-a-presigned-url|smart-link] 
** And for reading back in the {{S3EventNotificationMessage}} use {{s3.getObjectMetadata()}} to read the stored userDefined metadata
** S3Event Schema : [https://github.com/cabinetoffice/eip-ero-voter-card-applications-api/blob/main/src/main/resources/openapi/sqs/vca-api-sqs-messaging-erop.yaml#L60|https://github.com/cabinetoffice/eip-ero-voter-card-applications-api/blob/main/src/main/resources/openapi/sqs/vca-api-sqs-messaging-erop.yaml#L60]
* The document’s original name will be preserved. (Whatever filename UI sends to us while requesting pre-signed url, it will be returned/preserved/saved to the target)

h2. Implementation Details

* Process flow:
** UI will call POST /eors/{erodId}/applications/{applicationId}/document - this will return a pre-signed URL to allow the UI to call PUT with the file to S3
*** Note this API takes the mine type to be uploaded from the UI and will restrict the types allowed to generate URLs for
*** This mine type is also use in the AWS {{GeneratePresignedUrlRequest}} generate call.
*** Copied from VAC request: 
*** Extended with META DATA tags to allow filtering documents to different use cases.
**** {noformat}{
  ""fileName"": ""water_bill.pdf"",
  ""mimeType"": ""image/png"",
  ""documentType"": ""birth-certificate"",
  ""tags"": [""identity"", ""qa"", ""parent-guardian""]
}{noformat}
** The document will be placed in the new S3 source overseas {{document}} upload bucket
** The source S3 bucket will be listen out for any new documents/images and send a generic SQS message ({{S3EventNotificationMessage}}) to the new queue ({{move-overseas-uploaded-application-document}})
** The document will be moved to the existing S3 target overseas bucket under the same folder structure where existing id docs are present
** A new document record will be added to the list of documents for an application
** Infra changes will be required for the new queue for S3Events
* For all intent and purposes, the document should end up being treated like any document we currently receive from Softwire for digital applications. It should have the status {{RECEIVED}} once it’s been transferred between S3 buckets.
* As with digital applications documents, the s3arn (pointing to the target S3 bucket) should be stored against the record in the DB.
* The new document will be returned automatically when viewing an application’s list of documents on the Identity tab / or when calling GET document by Id (getting pre-signed GET URL)

h2. Acceptance Criteria

h3. S1: Get Document upload PUT url / proposed document id - (201)

*Given* the ERO user has a document to upload
*And* the application has not been determined (including in-progress)
*And* the ID verification has not been confirmed
*When* they request a S3 PUT URL (POST /eors/{erodId}/applications/{applicationId}/document) with all the required parameters (gss code, filename, mime type, document type)
*Then* the the API will return a 201 response containing the S3 PUT pre-signed URL and the proposed document id that will be subsequently created.
*And* when the client uses the PUT URL, the file created will contain the meta data (gss code, filename, mime type, document type, proposed document id)

h3. S2: Processing S3 File Created Event (S3 SQS)

*Given* the ERO user has made the S3 PUT document request
*And* the application associated not been determined (including in-progress)
*And* the associated application ID verification has not been confirmed
*When* the S3 event is received
*Then* the SQS listener will copy the source file to the target bucket
*And* will remove the source file
*And* will create the new document within the database for the application

h2. Error Scenarios

h3. S3: Invalid Request - (400)

*Given* the ERO user has a document to upload
*And* the application has not been determined (including in-progress)
*And* the ID verification has not been confirmed
*When* they request a S3 PUT URL (POST /eors/{erodId}/applications/{applicationId}/document) without all the required parameters (gss code, filename, mime type, document type)
*Then* the the API will return a 400 Bad Request Response
Rules:

# gss code not in current ERO
# mime type - not supported type (on OpenAPI spec)
# document type not supported (tbc - use category 1 and 2 for now)
# any field not provided

h3. S4: Application’s ID verification is Determined - (409)

h3. S5: The application has been Determined (409)

(Note that it is not possible to approve an application without confirming the ID verification, so this scenario only applies to rejected applications)

*S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,18/Aug/23 2:41 PM,11/Sep/23 12:01 PM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7208,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm I’ve seen document evidence
*So that* I can approve id verification without uploading documents

----

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have seen documents to confirm an electors id without havig to upload the actual document.

See VAC/POSTAL/PROXY /eros/{eroId}/applications/{applicationId}/documents/offline-document

----

h2. Requirements

* A document will be added to an application’s list of documents. 
* No document will be uploaded, only the type of document will be supplied.
* See [https://technologyprogramme.atlassian.net/browse/EIP1-6136|https://technologyprogramme.atlassian.net/browse/EIP1-6136|smart-link] to ensure the GetById for offline documents returns the ID  URL to allow document actions

----

h2. Acceptance Criteria

h3. S1: POST Offline Document - (201 Happy Path)

*Given* the ERO user wants to indicate they have seen an offline document
*And* the application has not been determined (including in-progress)
*And* the ID verification has not been confirmed
*When* they call the offline-document endpoint
*Then* the the API will return a 201 response to indicate the request has been saved with the application
*And* the document will be returned in the document collection from the Get Application By Id with a channel of “offline” (see VAC)

h2. Error Scenarios

h3. S3: Invalid Request - (400)

*Given* the ERO user wants to indicate they have seen an offline document
*And* the application has not been determined (including in-progress)
*And* the ID verification has not been confirmed
*When* a document type supplied is not defined in the supported list
*Then* the the API will return a 400 Bad Request Response
(this should be handled by the API gateway - we need to get a defined list of allowed documents - currently being refined - Cat1 and Cat 2 from VAC will be changing)

h3. S4: Application’s ID verification is Determined - (409)

h3. S5: The application has been Determined (409)

h3. *S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,18/Aug/23 2:43 PM,08/Sep/23 2:34 PM,,,,EIP1-4308,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7232,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my progress in actions taken to verify an applicant’s right to vote via their prior registration 

so that I can process the application 

*Context*

*Screen designs*

!image-20230825-162101.png|width=100%!

h2. 

h2. *Acceptance Criteria*

*AC2: Automated register check*

Given an authorised user is processing an application

WHEN they click the automated register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7234|https://technologyprogramme.atlassian.net/browse/EIP1-7234|smart-link] )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 



*AC2: Paper register check*

Given an authorised user is processing an application

WHEN they click the paper register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7236|https://technologyprogramme.atlassian.net/browse/EIP1-7236|smart-link]  )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 



*AC3: Previous address check*

Given an authorised user is processing an application

WHEN they click the proof of relationship link 

THEN the user should navigate to the proof of relationship with parent/ legal guardian page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7253|https://technologyprogramme.atlassian.net/browse/EIP1-7253|smart-link] )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 



*AC4 : local data matching*

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( see[https://technologyprogramme.atlassian.net/browse/EIP1-5283|https://technologyprogramme.atlassian.net/browse/EIP1-5283|smart-link] 

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) 



*AC4 : Documentary evidence* 

Given an authorised user is processing an application

WHEN they click the documentary evidence

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7358|https://technologyprogramme.atlassian.net/browse/EIP1-7358|smart-link] 

AND the local data matching should update based on updates to that page (confirmed/ not confirmed)



*AC6 : attestation* 

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7239|https://technologyprogramme.atlassian.net/browse/EIP1-7239|smart-link] )

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) ",To Do,,yusuf.eldin,,21/Aug/23 2:10 PM,11/Sep/23 9:59 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7233,Three,,Story,"*As an* authorised user processing applications 
*I want* to ensure applications statuses can be managed according to law
*So that*  EROs can only transition application states based on strict rules governing application processing.

h3. Application States

||*State*||*Description*||
|to-do|The default status of newly received and manually created applications.
An application's status can be set to “to-do” only if the application has not reached a final determination (approved / rejected)|
|on-hold|An application's status can be set to “on-hold” only if the application has not reached a final determination (approved / rejected)|
|in-progress|An application's status can only be set to “in-progress” only if the application has not reached a final determination (approved / rejected)|
|approval-in-progress|An application's status can be set to “approval-in-progress” only if the application:
# has not reached a final determination (approved / rejected)
# identity status has been set to verified
# register check has been set to “matched” and the emsElectorId field is populated.
# signature status has been set to accepted
This status is used to provide an intermediate step before final “approved” determination to mitigate against erroneous determinations.
This status is set when an ERO reviews the final details to be sent to the EMS before final “approval”|
|rejection-in-progress|An application's status can be set to “rejection-in-progress” only if the application has not reached a final determination (approved / rejected)
This status is used to provide an intermediate step before final “rejected” determination to mitigate against erroneous determinations.
This status is set when an ERO reviews the final details to be sent to the EMS before final “rejection”|
|approved|An application's status can be set to “approved” only if the application’s status is set to “approval-in-progress”
This status is used to indicate the completion of an application and that it is ready to be sent to the EMS. 
Once an application has been marked as “approved” it legally can not be amended or changed again.|
|rejected|An application's status can be set to “rejected” only if the application’s status is set to “rejection-in-progress”
This status is used to indicate the completion of an application and that it is ready to be sent to the EMS. 
When setting this status, the application must be updated to include application rejection reasons and optional notes
Once an application has been marked as “rejected” it legally can not be amended or changed again.|

h3. *Technical Notes:*

We currently have statuses of received and sent-to-ems. Suggesting we change received → to-do and we remove sent-to-ems and track using another field to indicate it has been sent and received by the ems (should be part of sending to EMS stories)

h2. Acceptance Criteria

h3. AC1: Unauthenticated

*Given* an unauthenticated user
*When* I try to call the *Set Application Status API*
*Then* I receive a 401 Unauthorised response

h3. *AC2: Unauthorised*

*Given* an *authorised user* is *NOT* in the *oe-admin* group for the *current ERO*
*When* I try to call the *Set Application Status API*
*Then* I receive a 403 Forbidden response

h3. *AC3:* Happy Path Set Application Status to to-do, in-progress, on-hold or rejection-in-progress

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is not set to {{approved | rejected}}
*When* I call the *Set Application Status API*
*And* pass a status of {{to-do | on-hold | in-progress | rejection-in-progress }}
*And* pass “notes” why the status is changing (optional)
*Then* the application's status will be updated to the status provided {{to-do | on-hold | in-progress | rejection-in-progress}}
*And* the application's status notes will be updated with the notes supplied

h3. *AC4:* Un-Happy Path Set Application Status to ANY STATUS where application is already “Determined”

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is set to {{approved}} or {{rejected}}
*When* I call the *Set Application Status API*
*Then* a 409 Conflict response will be returned 
*And* log a WARNING that an attempt has been made to change the status of a determined application, the eroId, the application Id and the ERO’s username / email address

h3. *AC5:* Happy Path Set Application Status to approval-in-progress

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is not set to {{approved}} or {{rejected}}
*And* the application’s identity status is {{vertified}}
*And* the application’s register status is {{matched}}
*And* the application’s register status has an {{emsElectorId}} value set
*And* the application’s signature status is {{accepted}}
*When* I call the *Set Application Status API*
*And* pass a status of {{approval-in-progress}}
*And* pass “notes” why the status is changing (optional)
*Then* the application's status will be updated to {{approval-in-progress}}
*And* the application's status notes will be updated with the notes supplied

h3. *AC6:* Un-Happy Path Set Application Status to approval-in-progress

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the the application exists in the *current ERO*
*And* the application’s status is not set to {{approved}} or {{rejected}}
*And* any of the following conditions are not met:

* the application’s identity status is not {{vertified}}
* the application’s register status is not {{matched}}
* the application’s register status doesn’t have an {{emsElectorId}} value set
* the application’s signature status is not {{accepted}}

*When* I call the *Set Application Status API*
*Then* a 409 Conflict response will be returned 
*And* log a WARNING that an attempt has been made to change the status of an application to approval-in-progress where the required conditions have not been met, the eroId, the application Id and the ERO’s username / email address

h3. *AC7:* Happy Path Set Application Status to approved

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is set to {{approval-in-progress}}
*And* the application’s identity status is {{vertified}}
*And* the application’s register status is {{matched}}
*And* the application’s register status has an {{emsElectorId}} value set
*And* the application’s signature status is {{accepted}}
*When* I call the *Set Application Status API*
*And* pass a status of {{approved}}
*And* pass “notes” why the status is changing (optional)
*Then* the application's status will be updated to {{approved}}
*And* the application's status notes will be updated with the notes supplied

h3. *AC8:* Un-Happy Path Set Application Status to approved

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* any of the following conditions are not met:

* the application’s application status is not {{approval-in-progress}}
* the application’s identity status is not {{vertified}}
* the application’s register status is not {{matched}}
* the application’s register status doesn’t have an {{emsElectorId}} value set
* the application’s signature status is not {{accepted}}

*When* I call the *Set Application Status API*
*Then* a 409 Conflict response will be returned 
*And* log a WARNING that an attempt has been made to change the status of an application to approved progress where the required conditions have not been met, the eroId, the application Id and the ERO’s username / email address

h3. *AC9:* Happy Path Set Application Status to rejected

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is set to {{rejection-in-progress}}
*When* I call the *Set Application Status API*
*And* pass a status of {{rejected}}
*And* pass a collection of rejection reasons (mandatory)
*And* pass “notes” why the status is changing (optional)
*Then* the application's status will be updated to {{rejected}}
*And* the application's rejection reasons will be updated with the reasons supplied
*And* the application's status notes will be updated with the notes supplied

h3. *AC10:* Un-Happy Path Set Application Status to rejected (409 - Conflict)

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is not set to {{rejection-in-progress}}
*When* I call the *Set Application Status API*
*And* pass a status of {{rejected}}
*Then* a 409 Conflict response will be returned 
*And* log a WARNING that an attempt has been made to change the status of an application to rejected where the required conditions have not been met, the eroId, the application Id and the ERO’s username / email address

h3. *AC11:* Un-Happy Path Set Application Status to rejected (400 - Bad Request)

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application exists in the *current ERO*
*And* the application’s status is set to {{rejection-in-progress}}
*When* I call the *Set Application Status API*
*And* pass a status of {{rejected}}
*And* do not pass a collection of rejected reasons
*Then* a 400 Bad Request will be returned
*And* log a WARNING that an attempt has been made to change the status of an application to rejected where the required conditions have not been met, the eroId, the application Id and the ERO’s username / email address

h3. *AC12:* Un-Happy Path Application Doesn’t Exist (404 - Not Found)

*Given* an *authorised user* in the *oe-admin* group for the *current ERO*
*And* the application doesn’t exists in the *current ERO*
*When* I call the *Set Application Status API*
*Then* a 404 Not Found response will be returned
*And* log a WARNING that an attempt has been made to change an application that doesn’t exist, the eroId, the application Id and the ERO’s username / email address",To Do,,Shane.yin,,21/Aug/23 2:12 PM,12/Sep/23 12:34 AM,,,,EIP1-4839,,8.0,,,,API|Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7234,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run register checks against an applicant’s details 

So that I can determine if an applicant is eligible to vote based on their previous registration status  

*Notes* 

policy decision still required on the actions that are available in relation to an exact match. e.g. should the register checker run and automatically determine the section based on the result from the register check. e.g. if the register checker returns an exact match should the section be automatically confirmed or still confirmed manually by an ERO 

UX question to understand if the ‘check register’ button should be removed if the register checker result has been returned and no details have been updated



*Screen Designs* 

!image-20230825-173852.png|width=607,height=1146!



h2. Acceptance Criteria

*AC1: Run register check*

GIVEN that the authorised user is in the qualifying address tab 

And wishes to run a register check on an under 18 leaver’s application 

When they click the check register button 

Then the register checker will run against the applicant’s details (see [https://technologyprogramme.atlassian.net/browse/EIP1-4500|https://technologyprogramme.atlassian.net/browse/EIP1-4500|smart-link])

and the date and time of the register check will be updated 



*AC2: Single Exact Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a Single match with the elector details in the EMS

WHEN the results from the automated checks returns the exact match

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND a text result from the register check will display ie Matches found on the register(1)

AND the EXACT MATCH text label with Green background with display

AND a Confirm Elector Register Check button

(See designs above)

 

*AC3: Single Partial Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a Single Partial match with the elector details in the EMS

WHEN the results from the automated checks returns the partial match

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND the differences will be highlighted in Yellow

AND a text result from the register check will display ie Partial Matches found on the register(1)

AND the PARTIAL MATCH text label with Dark Blue background with display

AND a Confirm Elector Register Check button

 

*AC4: Multiple Partial Matches*

GIVEN the authorised user is the qualifying address tab 

AND there is a multiple Partial matches with the elector details in the EMS

WHEN the results from the automated checks returns the matches

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND repeated one above the other for the number of matches

AND the differences will be highlighted in Yellow

AND a text result from the register check will display ie Partial Matches found on the register(>1)

AND the PARTIAL MATCH text label with Dark Blue background with display above each match

AND a Confirm Elector Register Check button under each match

 

 *AC5: No Match*

GIVEN the authorised user is the qualifying address tab 

AND there is a no match with the elector details in the EMS

WHEN the results from the automated checks returns the no match outcome

THEN the user will see the applicants details on the left side of the information panel

AND the elector details brought back from the EMS auto register check on the right side of the information panel

AND a text result from the register check will display ie No matches found

AND the NO MATCH text label with Dark Blue background with be displayed

 

*AC6: Pending* 

GIVEN the authorised user is the qualifying address tab 

AND the automated checks had yet to return a result

WHEN the user views the register checker results 

THEN the user will see a Pending autocheck results text message 

 

*AC7: Awaiting response from EMS*

GIVEN the authorised user is the qualifying address tab 

AND response from the EMS for the autocheck is yet to be received

THEN the user will see an Awaiting Response from EMS text label

AND the applicant details one the left

AND a blank EMS data panel on the right",To Do,,yusuf.eldin,,21/Aug/23 2:12 PM,08/Sep/23 2:49 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7237,Three,,Story,"As an authorised user

I Want to be able to determine if the application has passed all the required checks

So that I am able to process the postal application



*Assumptions*:

# Signature checks is a requirement for final determination. This is yet to be confirmed by policy. As a fall back we have included this as per Postal and Proxy applications but as mentioned clarity around signature as a requirement will need to be confirmed. {color:#0747a6}*Confirmation was made that Signatures and waivers is NOT a requirement for final determination as at 31/09/2023*{color}

h2. Scenarios

h3. *Screens*

Scenario1:  where all checks are approved/completed. 

!image-20230824-091431.png|width=2271,height=2571!

*Note*: Ignore the special category ‘Armed forces’ label on top right corner for now. This tag is to show the OE type that can be expected ie Registration, Residency or Left before 18yo

+Scenario2:  where not all checks have been completed+

!image-20230427-110854.png|width=789,height=556!

*Note:* 

# As we do not have designs for OE for the incomplete checks in the determination tab, the above is the postal representation, however, it is a similar pattern.

2. Ignore the special category ‘Armed forces’ label on top right corner for now. This tag is to show the OE type that can be expected ie Registration, Residency or Left before 18yo

h2. Acceptance Criteria

*AC1: Completed Status*

GIVEN that the ERO is in OE Application service

WHEN viewing the Determination Tab with completed statuses ie all checks have been set to completed

THEN the application summary header

AND the Review Application section with the current statuses of the relevant checks

AND all checks are in status ‘completed’

AND the ‘Review information to send to IER’ is active

AND the ‘Start rejection process’ button is active

h3. AC2: Not Completed status

GIVEN that the ERO is in OE Application service

WHEN viewing the Determination Tab with Incomplete statuses ie any check is incomplete status

THEN the application summary header

AND the Review Application section with the current statuses of the relevant checks

AND not all checks are in status ‘completed’

AND the ‘Review information to send to IER’ is not active

AND the ‘Start rejection process’ button is active

----

h3. Design

[https://valtech.invisionapp.com/console/DLUHC---OAVA-Page-layouts-cleczg2wd0owt017xazmha71e/clemmlznq520f01bo260v9iav/play|https://valtech.invisionapp.com/console/DLUHC---OAVA-Page-layouts-cleczg2wd0owt017xazmha71e/clemmlznq520f01bo260v9iav/play|smart-link] ",To Do,,Shane.yin,,21/Aug/23 2:23 PM,07/Sep/23 3:09 PM,,,,EIP1-4839,,3.0,,,,Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7238,Three,,Story,"As an ERO making the final determination

I WANT to be able to review all relevant checks

AND approve the application should all checks have been passed

So that approved final determination can be done

*Context*

The Determination tab will be the place where the ERO can view all relevant checks ie Register, Identity, signature checks etc for the applicant and be able to make the final determination. This story is the final approval of the Postal application process.

*Assumption*

* The following API work need to be done prior to UI work. [https://technologyprogramme.atlassian.net/browse/EIP1-7263|https://technologyprogramme.atlassian.net/browse/EIP1-7263|smart-link] ‘Cancel’ button in blue status banner will only be displayed but have no action
* Signature is provided in this journey, signature waiver is in separate story. *NOTE out standing question if signature and waivers are a requirement for OE*.
* The set application status api has been done ( See [https://technologyprogramme.atlassian.net/browse/EIP1-7233|https://technologyprogramme.atlassian.net/browse/EIP1-7233|smart-link]  )
* All relevant checks ie registry, identity and signature checks have all been passed/approved. However, if not all approved, the ERO can still have the final decision to approve the application.
* Story  [https://technologyprogramme.atlassian.net/browse/EIP1-7237|https://technologyprogramme.atlassian.net/browse/EIP1-7237|smart-link] is done before this story
* The final status will be initially set to ‘Approved’ for now. In future API updates the final status will be set to Information sent to EMS
* {color:#bf2600}Signature section is still unknown if this is to be included as with the signature checks as policy has yet to decide on this. At the moment we are to include it as a fall back. {color}{color:#0747a6}*Confirmation was made that Signatures and waivers is NOT a requirement for final determination on 31/09/2023*{color}

*Screens*

When ERO first entered the determination tab will all relevant checks approved. This view is handled by [https://technologyprogramme.atlassian.net/browse/EIP1-7237|https://technologyprogramme.atlassian.net/browse/EIP1-7237|smart-link]  )

!image-20230424-095626.png|width=734,height=516!

*Note:* Ignore the special category ‘Armed forces’ label on top right corner for now. This tag is to show the OE type that can be expected ie Registration, Residency or Left before 18yo

+Approval In Progress : When user selects the Review information to send to EMS button+

!image-20230824-080235.png|width=2271,height=6527!

{color:#bf2600}*Note: Confirmation that Signature is not longer a requirement*{color}

[https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=38-79692&mode=design&t=BWewAOdnk5mPWOoD-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=38-79692&mode=design&t=BWewAOdnk5mPWOoD-4|smart-link] 

+Confirmation Screen+

!image-20230824-080506.png|width=2271,height=6349!

*Notes:* 

{color:#bf2600}*Status ‘Information Sent to EMS’ should show as ‘Information Sent to IER’*{color}

{color:#bf2600}*Confirmation that Signature is not longer a requirement*{color}

[https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=50-90081&mode=design&t=BWewAOdnk5mPWOoD-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=50-90081&mode=design&t=BWewAOdnk5mPWOoD-4|smart-link] 

h2. Acceptance Criteria

+*AC1:*+ +WHEN user selects Review Information to send to EMS button+

GIVEN that the ERO is in the Determination Tab

WHEN the ERO selects the ‘Review Information to send to IER’ button ( API = [https://technologyprogramme.atlassian.net/browse/EIP1-7233|https://technologyprogramme.atlassian.net/browse/EIP1-7233|smart-link]  )

THEN the ERO will see the status of ‘Approval in Progress' in the summary header 

AND the Review section will show all the relevant check statuses ie Register, Identity and Signature

AND a blue banner with ‘Application pre-approved’ message with ERO name and datetime with *Cancel button*(see below)

!image-20230424-134108.png|width=685,height=47!

AND the application details the ERO will be approving for final determination

AND the Signature that was provided

AND lastly the Approve Postal application button

+*AC2*++:  Approval Confirmation+

GIVEN that the ERO has selected the ‘Review Information to send to IER’ button 

THEN the ERO will see that the application summary status will be set to ‘Approved’

AND the Review section will show all the relevant check statuses ie Register, Identity and Signature

AND a blue banner with ‘Application pre-approved’ message with ERO name and datetime(see below)

!image-20230424-163512.png|width=814,height=54!

AND the Approve application a confirmation green banner (See below)

!image-20230424-151457.png|width=813,height=50!

AND the application details the ERO will be approving for final determination

AND the Signature that was provided

with message, ERO name and date and time

*Note*

The final status will be initially set to ‘Approved’ for now. In future API updates the final status will be set to Information sent to EMS via IER. See [https://technologyprogramme.atlassian.net/browse/EIP1-5257|https://technologyprogramme.atlassian.net/browse/EIP1-5257|smart-link] ",To Do,,Shane.yin,,21/Aug/23 2:44 PM,01/Sep/23 12:28 PM,,,,EIP1-4839,,8.0,,,,Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7239,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to record the local data matching I have done against an application 

So that I can determine if an applicant is eligible to vote based on local data matching results 

*Notes*

*Notes*

Local data checks flow is applicable to all Overseas application routes including under 18 leaver, registration and residency the UI will remain the same for all routes however the page title will change dependent upon the application type 



*Screen Designs*

!image-20230817-125025.png|width=75%!

(note: title edit needed to show Qualifying address registration left under 18) 

!image-20230817-125441.png|width=75%!





*Acceptance criteria* 

*AC1 accept local data matching* 

Given an Ero admin is in the qualifying address tab

And they have reviewed the local data matching information for an applicant 

When they click the confirm local data matching button 

Then a banner will show with ‘local data match confirmed’ ERO name date and time 

and the application status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7326|https://technologyprogramme.atlassian.net/browse/EIP1-7326|smart-link] 

and the task list section will be updated to show confirmation 



*AC2 reject t local data matching* 

Given an Ero admin is in the qualifying address tab

And they have reviewed the local data matching information for an applicant 

When they click the reject local data matching button 

Then a banner will show with ‘cannot confirm local data match’ ERO name date and time 

and the application status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7326|https://technologyprogramme.atlassian.net/browse/EIP1-7326|smart-link] 

and the task list section will be updated to show rejection.",To Do,,yusuf.eldin,,21/Aug/23 2:57 PM,08/Sep/23 2:33 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7241,Three,,Story,"As an ERO making the final determination

I WANT to be able to review all relevant checks

AND reject the application should not all checks have been passed or ERO is had decided to reject the application

So that approved final determination can be done

*Context*

The Determination tab will be the place where the ERO can view all relevant checks ie Register, Identity, signature checks etc for the applicant and be able to make the final determination. This story is the final rejection process of the Postal application process.

*Assumption*

* The set application status api has been done ( See [https://technologyprogramme.atlassian.net/browse/EIP1-7233|https://technologyprogramme.atlassian.net/browse/EIP1-7233|smart-link]  )
* Not all relevant checks ie registry, identity and signature checks have all been passed/approved. 
* Story [https://technologyprogramme.atlassian.net/browse/EIP1-7237|https://technologyprogramme.atlassian.net/browse/EIP1-7237|smart-link]  is done before this story
* This story assumes that a signature was provided and NOT a signature waiver. 
* {color:#bf2600}Signature section is still unknown if this is to be included as with the signature checks as policy has yet to decide on this. At the moment we are to include it as a fall back.{color}{color:#0747a6} *Note: Confirmation that Signature is no longer a requirement on 31/08/2023*{color}

*List of Rejection reasons*

* Unable to confirm applicant's identity
* Unable to confirm applicant has a qualifying address in the UK
* Unable to confirm applicant is a British Citizen
* Applicant is already registered as an Overseas Elector****
* Application contains inaccurate information
* Suspected fraudulent application
* Duplicate application
* Unable to confirm connection with parent/guardian*(for under 18 Leavers ONLY)*
* Other

***in this case, they need to be sent details of the renewal process, rather than a standard rejection(Policy need to be confirm)*



*NOTE*: 

* There is a story to ensure the API model is updated with this list. See [https://technologyprogramme.atlassian.net/browse/EIP1-6002?atlOrigin=eyJpIjoiZGUyMDMyZDMxM2IxNDg2OGI5OTcxMjdiY2Q0YzYzMjkiLCJwIjoiamlyYS1zbGFjay1pbnQifQ|https://technologyprogramme.atlassian.net/browse/EIP1-6002?atlOrigin=eyJpIjoiZGUyMDMyZDMxM2IxNDg2OGI5OTcxMjdiY2Q0YzYzMjkiLCJwIjoiamlyYS1zbGFjay1pbnQifQ|smart-link] 

*Screens*

When ERO first entered the determination tab with some checks in Incomplete status. This is handled by [https://technologyprogramme.atlassian.net/browse/EIP1-7237|https://technologyprogramme.atlassian.net/browse/EIP1-7237|smart-link]  )

!image-20230427-112728.png|width=785,height=547!

*Note*: 

{color:#bf2600}*Confirmation that Signature is no longer a requirement and therefore only Identity and Register checks are required.*{color}

Ignore the special category ‘Armed forces’ label on top right corner for now. This tag is to show the OE type that can be expected ie Registration, Residency or Left before 18yo

+Rejection In Progress: select reasons for rejection+

!image-20230427-113630.png|width=734,height=849!

+Rejection In Progress: When user has selected the ‘Start Rejection Process’ button+

!image-20230824-080810.png|width=2271,height=6527!



*NOTE:* 

# The design above shows the approval In Progress Banner however, the rejection In Progress banner will be similar but but with rejection message . See ACs below

2. Signature waiver is in designs but this story assumes that a signature was provided and therefore an uneditable image of signature will be displayed in place of the signature waiver. {color:#bf2600} *Confirmation that Signature is no longer a requirement and therefore only Identity and Register checks are required.*{color}



+Rejection Confirmation+

!image-20230824-081215.png|width=2271,height=6349!

*NOTE:* 

# The design above shows the approval In Progress Banners however, the rejection In Progress banner will be similar but but with rejection message . See ACs below
# Signature waiver is in designs but this story assumes that a signature was provided and therefore an uneditable image of signature will be displayed in place of the signature waiver. {color:#bf2600}*Confirmation that Signature is no longer a requirement and therefore only Identity and Register checks are required.*{color}

h2. Acceptance Criteria

+*AC1:*+ +WHEN user selects Start Rejection Process button+

GIVEN that the ERO is in the Determination Tab

AND at least 1 of the checks statuses is ‘Incomplete’

WHEN the ERO selects the ‘Start Rejection Process’ button

THEN the ERO will see the following:

*  the status of ‘In Progress' in the summary header 
*  the Review application section with rejection reasons checkboxes (multi-select) Please see the list of latest rejection reasons above
* a text box for other rejection comments(optional)_{Condition: If Other checkbox is checked THEN textbox is mandatory}_ 
* the Reject Application button 
* a cancel button ( See image above)

+*AC2*++: Rejection In Progress+ 

GIVEN that the ERO is in the Determination Tab

AND has selected rejection reasons checkboxes

AND entered in other rejections comments (optional)

AND the ERO has selected the ‘Reject Application’ button

THEN the ERO will see the status of ‘Rejection  in Progress' in the summary header 

AND the following: 

* the Review section will show all the relevant check statuses ie Register, Identity and Signature
* a Blue banner with ‘Application rejection process started’ message with ERO name and datetime with *Cancel button*(see below)

!image-20230427-114927.png|width=682,height=46!

* the Reasons for rejection listed
* the application details the ERO will be rejecting for final determination
* the Signature that was provided

AND lastly the Reject Application button

+*AC3*++: Confirmation+

GIVEN that the ERO has selected the ‘Reject Application’ button 

WHEN the application status is in ‘Rejection In Progress’

THEN the ERO will see the status of ‘Rejected' in the summary header 

AND  the following:

* the Review section will show all the relevant check statuses ie Register, Identity and Signature
* a Blue banner with ‘Application rejection process started by’ message with ERO name and datetime ( See Below)

!image-20230427-115524.png|width=686,height=47!

*NOTE*: this is date and time of when the ERO had placed the application in pre-rejected status ie Rejection In Progress

* the Reasons for rejection listed
* the Reject application section with a rejected confirmation banner (See below)

!image-20230427-115647.png|width=684,height=48!

*Note*: This is the date and time when the ERO had placed the application in Rejected staus ie Rejection in Progress to Rejected

with message, ERO name and date and time

* the application details the ERO will be rejecting for final determination
* the Signature that was provided",To Do,,Shane.yin,,21/Aug/23 2:58 PM,11/Sep/23 12:01 PM,,,,EIP1-4839,,8.0,,,,Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7253,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run historical address checks against an applicant 

So that I can determine if an applicant is eligible to vote based on their previous registration status  

*Screen Designs*

!image-20230822-101527.png|width=627,height=799!



h2. Acceptance Criteria

*AC1: No previous address match*

GIVEN that the authorised user is in the qualifying address tab 

And wishes to check the status of the DWP check on an applicant’s previous residency ([https://technologyprogramme.atlassian.net/browse/EIP1-7331|https://technologyprogramme.atlassian.net/browse/EIP1-7331|smart-link] )

When they click link to the previous address check page

Then the UI will display the address that the citizen has entered 

And the ‘no match’ status 

And a banner will show with ‘no match found by system’, and the date and time 



*AC2: Previous address match* 

GIVEN that the authorised user is in the qualifying address tab 

And wishes to check the status of the DWP check on an applicant’s previous residency ([https://technologyprogramme.atlassian.net/browse/EIP1-7331|https://technologyprogramme.atlassian.net/browse/EIP1-7331|smart-link] )

When they click link to the previous address check page

Then the UI will display the address that the citizen has entered 

And the ‘matched’ status 

And a banner will show with ‘match found by system’, and the date and time 

 ",To Do,,yusuf.eldin,,22/Aug/23 11:12 AM,08/Sep/23 2:50 PM,,,,EIP1-7231,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7254,Three,,Story,this ticket will cover the re-run of register checks when an applicant’s details are edited,To Do,,Krister Bone,,22/Aug/23 11:59 AM,12/Sep/23 1:04 AM,,,,EIP1-4886,,,,,,API|Beta|NotRefined|OE|Valtech,,,,
EIP1-7262,Three,,Story,"As an ERO

I WANT to be able to undo/Cancel while an application is in Approval In Progress or Rejection in Progress state

So that I can able to reverse my initial determination decision.

*Context*

This story is to allow the ERO to review the relevant checks statuses and applicant details ie Approval In Progress or Rejection In Progress prior to making the final determination to approve or reject the application and also allow the ERO to undo/cancel and return the status back to In Progress. (API [https://technologyprogramme.atlassian.net/browse/EIP1-7233|https://technologyprogramme.atlassian.net/browse/EIP1-7233|smart-link]  )



*Assumption*

The following API work need to be done prior to UI work. [https://technologyprogramme.atlassian.net/browse/EIP1-7263|https://technologyprogramme.atlassian.net/browse/EIP1-7263|smart-link] 

*Screens*

+Rejection In Progress+

!image-20230503-102430.png|width=682,height=799!

+Approval In Progress+

!image-20230503-102542.png|width=50%!

Determination Tab View(Returned state)

!image-20230503-102721.png|width=683,height=559!

h2. Acceptance Criteria

GIVEN that the ERO has put the application in Approval In progress or Rejection In Progress state

WHEN the ERO wishes to undo/Cancel their initial decision ie selects the Cancel button

THEN the application status will be put back to ‘In Progress’ status

AND the ERO will be returned to the start of the determination journey(See image above)",To Do,,Shane.yin,,22/Aug/23 2:24 PM,01/Sep/23 12:27 PM,,,,EIP1-4839,,2.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7263,Three,,Story,"As the OAVA portal

I WANT to be able to capture the ERO name/email and date time when the Approval In Progress or Rejection In Progress was made in the determination process

So THAT the user is able to see this information



*Context*

Current data structure does not support the ability to capture the Pre-approval info ie the datetime and person(ERO) who has put the application into Approval In Progress state. There is a requirement to show this information in a banner ie datetime and ERO when final determination was made as well as datetime and the ERO who made the final determination is shown.

Conversely, the same goes for Rejection In progress where this information must also be captured and displayed for the Rejection journey



*Tech Notes*

It’s worth noting that the solution in VAC is not what we are looking for as it uses the same state as the application state for this. 

The requirement here is to add three new attributes to the application status:

# previous state
# modified by 
# modified when

These three attributes are to be populated when an application is either approved or rejected. So for example, an ero views this application in progress and selects to reject it. At that point the update status endpoint is called to change the status to rejected. Before the status is changed, the app needs to get the current state, ero and timestamp and assign those values to the attributes above. Then the application will change state to rejected. 

The response to the client is a 2xx success message so they know it’s been updated (as it currently already does) but also the response is now augmented with the previous state details so that can be shown on the UI.",To Do,,Shane.yin,,22/Aug/23 2:31 PM,01/Sep/23 12:27 PM,,,,EIP1-4839,,5.0,,,,API|Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7265,Three,,Story,"As an ERO in determination journey

I WANT to see rejection notes if provided when the application is in Rejection In Progress or Rejected status

So that the ERO can see all rejection reasons with any useful notes that may have been provided



*Designs*

!image-20230524-135124.png|width=770,height=706!

*Notes:* 

If Application is rejected and rejection notes has been provided then it should display as Additional Input

If NOT Provided then should not display Additional Input field(See below)

!image-20230524-135752.png|width=773,height=567!



h3. Acceptance Criteria

AC1: Rejection notes provided

GIVEN that the ERO is in the making final determinations

WHEN the ERO has placed the application in Rejection In Progress or Rejected status

AND rejection notes has been provided

THEN any additional rejection notes provided must display as Additional Input (See image 1 above)



AC2: Rejection Notes NOT provided

GIVEN that the ERO is in the making final determinations

WHEN the ERO has placed the application in Rejection In Progress or Rejected status

AND rejection notes has not been provided

THEN any additional rejection notes provided must NOT display as Additional Input field(See image 2 above)",To Do,,Shane.yin,,22/Aug/23 2:57 PM,01/Sep/23 12:26 PM,,,,EIP1-4839,,1.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7272,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record documents that has been uploaded and accepted in support of an application for under 18 leavers

So that I can process this application



*Context*

When an applicant is applying under previous registration an ERO will see the following screen, and can check the applicant’s evidence related to their UK residence.

This ticket will cover uploading documents as well as adding offline documents.

*Notes*  

Attestation flow is applicable to all Overseas application routes including under 18 leaver, registration and residency the UI will remain the same for all routes however the page title will change dependent upon the application type 



*Screen designs*

!image-20230830-164052.png|width=645,height=1229!



h2. *Acceptance Criteria*

*Upload Document*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

*AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Choose file’ CTA

THEN the upload file facility will allow a user to upload a document [https://technologyprogramme.atlassian.net/browse/EIP1-7300|https://technologyprogramme.atlassian.net/browse/EIP1-7300|smart-link] 

AND ‘No File chosen’ should be replaced by the uploaded file name

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, Accept and Reject buttons and a link to the document

*AC4:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document

THEN the document should show in a ‘loading state’ in the documents for review tab, until the upload is confirmed



*Add document as seen*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

 *AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Add document’ CTA

THEN the user will see the document in the ‘Documents for review’ section [https://technologyprogramme.atlassian.net/browse/EIP1-7309|https://technologyprogramme.atlassian.net/browse/EIP1-7309|smart-link] 

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has added a document as seen

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, ‘Accept document as seen’ and ‘Reject document as seen’ buttons",To Do,,yusuf.eldin,,22/Aug/23 4:26 PM,08/Sep/23 2:34 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7274,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to reject attestations added as seen in support of an overseas elector application 

So that I can process this application

*Context*

When an applicant is applying through the exceptions route they can provide an attestation 

The attestation flow is available on all overseas elector application types including under 18, registration and residency 

This ticket will cover rejecting uploaded documents, and documents added as seen.

*Notes*

* Providing a rejection reason for a document is optional
* when other is provided as a rejection reason, notes field is mandatory 

*Assumption*  

* {color:#ff5630}Rejection reasons list in screenshot mirrors the current list for postal/proxy, an updated list may be required for attestation. {color}




*Screen Design*

!image-20230816-202348.png|width=100%!

*Rejection reasons list* 

!reject1ion reasons list -20230817-121105.png|width=100%!

*Rejection document CTA*

!image-20230901-201709.png|width=917,height=244!



* *ACCEPTANCE CRITERIA*
*AC1 a: Reject uploaded document reason*
GIVEN that the authorised user is in the Identity Tab
AND is reviewing uploaded documents in the ‘Documents for review’ section
WHEN the user clicks the ‘Reject document’ button
THEN the UI will show the reject document reasons
AND a text box to add additional explanation for rejection
AND a Reject document and cancel button
 
*AC2a: Reject CTA*
GIVEN that the authorised user is rejecting a document under review
AND *selects rejection reasons*
WHEN the user rejects a document by clicking on the reject document button
THEN the rejected document will appear in Rejected document section
AND the document will show ‘Rejected reason’, ERO name and date and time of rejection and a link to the document
AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 
 
*AC2b: Reject with no reason selected*
 
GIVEN that the authorised user is rejecting a document under review
*AND does not select a rejection reason*
WHEN the user rejects a document by clicking on the reject document button
THEN the rejected document will appear in Rejected document section
AND the document will show ERO name and date and time of rejection
AND *rejected reason* will show *‘not provided’*
AND the ‘Undo reject document’ button will be displayed
AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 
 
*AC2b: Reject CTA with additional information*
 
GIVEN that the authorised user is rejecting a document under review
*AND adds additional information*
WHEN the user rejects a document by clicking on the reject document button
THEN the rejected document will appear in Rejected document section
AND the document will show ‘Rejected reason’, ERO name and date and time of rejection
AND an extra field *‘additional information’ will show below.*
AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] ",To Do,,yusuf.eldin,,22/Aug/23 4:26 PM,08/Sep/23 2:37 PM,,,,EIP1-4494,,,,,,Beta|OE|RefineInProgress|UI|Valtech,,,,Impediment
EIP1-7275,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to undo determinations made on documents added in support of an overseas elector application 

So that I can correct mistakes I have made, or update a determination based on new information. 

*Context*

When an applicant is applying under the previous registration of a parent/guardian the ERO will see the following screen, and can undo actions (accept/ reject) made on the documents)

This ticket will cover undo for uploaded and offline documents 

*Screen Design*

!image-20230906-133249.png|width=794,height=797!



h2. Acceptance Criteria

*AC3: Undo rejected document*

GIVEN an ERO has rejected a document in the document for review section

WHEN the document displays in the rejected documents section

THEN the rejected document will show an undo accept reject button



*AC4: Undo rejected document*

GIVEN a document is in the rejected documents section

WHEN the ERO clicks the undo reject document button

THEN the document status should be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link]  to remove rejection

AND the document will move back into the documents for review section",To Do,,yusuf.eldin,,22/Aug/23 4:26 PM,11/Sep/23 4:19 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7276,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my determination regarding an applicant’s attestation evidence 

so that I can process the application 

*Context*

Once all relevant checks has been made i.e. all attestation documents have been reviewed and an ERO has confirmed whether it is sufficient or not to confirm or not the validity of the relationship 

*Assumptions*

* attestation documents has been provided in support of the application and/or
* attestation documentation has been provided and uploaded

*Screen Design*

!image-20230830-164705.png|width=645,height=1229!

!image-20230901-201242.png|width=743,height=1105!



h3. Acceptance Criteria

*AC1: accept relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their application 

WHEN the user clicks on the Confirm attestation button 

THEN a banner with text confirmation message, ERO email and date and time and ‘attestation confirmed’ will be displayed 

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7327|https://technologyprogramme.atlassian.net/browse/EIP1-7327|smart-link] 



*AC2: reject relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their application 

WHEN the user clicks on the ‘cannot confirm’ attestation button 

THEN a banner with text confirmation message, ERO email and date and time and ‘cannot confirm attestation’ will be displayed 

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7327|https://technologyprogramme.atlassian.net/browse/EIP1-7327|smart-link] ",To Do,,yusuf.eldin,,22/Aug/23 4:27 PM,08/Sep/23 2:40 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7283,Three,,Story,"As an authorised user in the qualifying address tab 

I want to be able to record my progress in actions taken to verify a applicant’s right to vote via an application for a previous registration. 

So that I can process the application 

*Context*

*Screen designs*

!image-20230825-161952.png|width=605,height=986!



h2. *Acceptance Criteria*

*Upload Document*

*AC1: Previous address check*

Given an authorised user is processing an application

WHEN they click the proof of relationship link 

THEN the user should navigate to the proof of relationship with parent/ legal guardian page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7253|https://technologyprogramme.atlassian.net/browse/EIP1-7253|smart-link] )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 

*AC2: Automated register check*

Given an authorised user is processing an application

WHEN they click the automated register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7234|https://technologyprogramme.atlassian.net/browse/EIP1-7234|smart-link] )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 

*AC3: Paper register check*

Given an authorised user is processing an application

WHEN they click the paper register check of parent/guardian

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7236|https://technologyprogramme.atlassian.net/browse/EIP1-7236|smart-link]  )

AND the proof of relationship status should update based on updates to that page (confirmed/ not confirmed) 

*AC4 : local data matching*

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( see[https://technologyprogramme.atlassian.net/browse/EIP1-5283|https://technologyprogramme.atlassian.net/browse/EIP1-5283|smart-link] 

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) 



*AC4 : Documentary evidence* 

Given an authorised user is processing an application

WHEN they click the documentary evidence

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7358|https://technologyprogramme.atlassian.net/browse/EIP1-7358|smart-link] 

AND the local data matching should update based on updates to that page (confirmed/ not confirmed)



*AC5 : attestation* 

Given an authorised user is processing an application

WHEN they click the local data matching 

THEN the user should navigate to the electoral register check page ( see [https://technologyprogramme.atlassian.net/browse/EIP1-7239|https://technologyprogramme.atlassian.net/browse/EIP1-7239|smart-link] )

AND the  local data matching  should update based on updates to that page (confirmed/ not confirmed) ",To Do,,yusuf.eldin,,23/Aug/23 2:51 PM,06/Sep/23 11:24 PM,,,,EIP1-7231,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7285,Three,,Story,"*As a* ERO processing the qualifying address details provided by the elector
*I want* to set the status to approved or rejected
*So that* I can determine the application


----

h2. *Acceptance Criteria*

h3. AC1: Accept Qualifying Address Information

*Given* an *ERO* processing a overseas application
*And* one of the following sub-determinations has been approved - Under 18, Residency, Registration, Documentary evidence, Local Data match or Attestation
*When* I call the *Set Qualifying AddressStatus API* to {{approved}}
*And* I send accompanying notes with the approval
*Then* the Qualifying Address status will be set to {{approved}}
*And* the Qualifying Address will have the notes set to the the notes provided
*And* the GetByID API will return the updated values


h3. AC2: Reject  Qualifying Address

*Given* an *ERO* rejecting the qualified information on a overseas application
*When* I call the *Set Qualifying Address Status API* to *rejected* with an *rejectionReason(s),* with *Rejected Reason Notes*
*Then* the Qualifying Address status will be set to {{rejected}}
*And* the Qualifying Address rejected status reason(s) will be set to the rejectedReason(s)
*And* the Qualifying Address rejected status reason notes will be set to the rejected reason notes

h3. AC3: Empty reasons

*Given* an *authorised user*
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database
*When* I call the *Set Qualifying Address Status API:*
| status | approvalReason | rejectedReason |
| approved | null/empty | null/empty |
| rejected | null/empty | null/empty |
*Then* a 400 BAD_REQUEST response will be returned

h3. AC4: Application’s Qualifying Address Check is Determined - (409)

h3. AC5: The application has been Determined (409)

h3. *AC6:* (i) (Plus the usual 401/403/404 etc)



----



*Assumptions*

* There is no requirement for any comms being generated by the EROP to the applicant; therefore no reject reason (free form text) is needed
* one reason can be selected
* does not update application status

----

*Implementation Notes*

Possible API:

{noformat}{     
    status: string (accepted | rejected)     
    rejectionStatusReason?: oneOf <rejectionReasons>
    approvalStatusReason?: oneOf <approvalReasons>     
 }

  rejectionReasons: [
    tbc
    other
]

approvalReasons: [
    viewed-in-erop
    verified-offline
]{noformat}",To Do,,Krister Bone,,23/Aug/23 3:56 PM,08/Sep/23 2:32 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7287,Three,,Story,"As an ERO administrator assessing overseas elector applications

I want to record notes against an application  

So that I can document the reasoning for my actions 

*Background* 

After making a determination in the following qualifying address sections an ERO admin will have the ability to log notes in order to capture why they have made the determination. Notes should persists and be editable when an ERO returns to the page. 

* Local data match
* Attestation 
* Documentary evidence
* Paper register checks 



*Screen designs* 

# Screen prior to determination 

!image-20230905-202227.png|width=100%!

2. Notes section displaying once determination is made 

!image-20230905-202400.png|width=100%!

3. section once note has been added with change links 

!image-20230905-202522.png|width=819,height=596!



*Acceptance criteria* 

*AC1* 

GIVEN an ERO admin has made a determination on local data match, attestation, documentary evidence or paper register checks. 

WHEN they click the confirm or not confirm CTA 

THEN a text area box will display in the UI 

AND the ERO can input notes into the text area. 



*AC2 Save note* 

GIVEN an ERO admin has made a determination on a qualifying address section 

AND has added input notes into the text area

WHEN they click the ‘add note’ button 

THEN the note will be saved against that section  [https://technologyprogramme.atlassian.net/browse/EIP1-7299|https://technologyprogramme.atlassian.net/browse/EIP1-7299|smart-link] 

AND the saved note should be displayed when the ERO returns to that section. 



*AC2 Edit note*  

GIVEN that an ERO has added notes against a qualifying address section determination

AND has returned to the relevant section where the note is displayed 

WHEN they click the ‘change’ link 

THEN the note should open in the text area and allow the ERO to edit the existing note [https://technologyprogramme.atlassian.net/browse/EIP1-7339|https://technologyprogramme.atlassian.net/browse/EIP1-7339|smart-link] 



*AC2 Delete note*  

GIVEN that an ERO has added notes against a qualifying address section determination

AND has returned to the relevant section where the note is displayed 

WHEN they click the ‘change’ link 

THEN the note should open in the text area and allow the ERO to delete the existing note [https://technologyprogramme.atlassian.net/browse/EIP1-7411|https://technologyprogramme.atlassian.net/browse/EIP1-7411|smart-link] ",To Do,,yusuf.eldin,,23/Aug/23 4:44 PM,08/Sep/23 2:41 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7293,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to see an applicant’s current OE registration status 

so that I can check if the applicant already has a registration to vote as an overseas elector 

*Context*

This screen will cover the UI elements required to inform ERO’s when an applicant has a current active voter registration. To prevent duplicate applications, or for applications being approved outside of an applicant's renewal window. The current voter registration status is determined based on the franchise code returned from the EMS during the historic register checks. [https://technologyprogramme.atlassian.net/browse/EIP1-4500|https://technologyprogramme.atlassian.net/browse/EIP1-4500|smart-link] 

*Screen designs*

!image-20230825-174027.png|width=561,height=1100!



h2. *Acceptance Criteria*

*AC1* 

Given an ERO admin has run an electoral register check to determine an applicant’s eligibility to vote as an overseas elector 

When they use the ‘check register’ button 

THEN the UI should return current elector registrations which match the application details. [https://technologyprogramme.atlassian.net/browse/EIP1-4500|https://technologyprogramme.atlassian.net/browse/EIP1-4500|smart-link] 

AND the current registration start date and registration expiry date should be shown 

AND the requested registration start date and expiry date should be shown  



*AC2*

GIVEN an electoral register check has returned details of an active current overseas voter registration.

WHEN the elector details are displayed in the UI 

THEN a warning message will be displayed in the UI confirming that the applicant is registered as an overseas elector 

AND the warning message will show the  number of months until their current registration will expire. ",To Do,,yusuf.eldin,,23/Aug/23 5:43 PM,11/Sep/23 10:08 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7294,Three,,Story,this ticket will cover the re-run of register checks when an applicant’s details are edited,To Do,,Krister Bone,,23/Aug/23 6:21 PM,12/Sep/23 1:05 AM,,,,EIP1-4886,,,,,,API|Beta|NotRefined|OE|Valtech,,,,
EIP1-7295,Three,,Story,this ticket will cover the re-run of register checks when an applicant’s details are edited,To Do,,Krister Bone,,23/Aug/23 6:21 PM,12/Sep/23 1:05 AM,,,,EIP1-4886,,,,,,API|Beta|NotRefined|OE|Valtech,,,,
EIP1-7297,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record documents that has been uploaded and accepted in support of an overseas elector application 

So that I can process this application

*Context*

When an applicant has provided evidence to support their application to register as an overseas elector an ERO can use the following screen to upload or document evidence that they have seen. 

This ticket will cover uploading documents as well as adding offline documents. 

h3. Notes

*Screen designs*

!image-20230901-200609.png|width=491,height=909!

*Documents uploaded* 

!image-20230901-201604.png|width=100%!



h2. *Acceptance Criteria*

*Upload Document*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

*AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Choose file’ CTA

THEN the upload file facility will allow a user to upload a document [https://technologyprogramme.atlassian.net/browse/EIP1-7300|https://technologyprogramme.atlassian.net/browse/EIP1-7300|smart-link] 

AND ‘No File chosen’ should be replaced by the uploaded file name

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, Accept and Reject buttons and a link to the document

*AC4:*

Given an authorised user is in the Identity Tab

WHEN the user has uploaded a supporting document

THEN the document should show in a ‘loading state’ in the documents for review tab, until the upload is confirmed

*Add document as seen*

*AC1:*

Given an authorised user is processing an application

WHEN the authorised user is in the Identity Tab view

AND clicks 'Add document for Review' CTA

THEN the ‘Add document for review’ section will expand to reveal a drop down list of document types

AND the authorised user can select a document type from the list

 *AC2:*

Given an authorised user is in the Identity Tab

AND has selected a document type from the drop down list

WHEN the user clicks the ‘Add document’ CTA

THEN the user will see the document in the ‘Documents for review’ section [https://technologyprogramme.atlassian.net/browse/EIP1-7309|https://technologyprogramme.atlassian.net/browse/EIP1-7309|smart-link] 

AND if the user clicks add document without selecting document type then an error message will display

*AC3:*

Given an authorised user is in the Identity Tab

WHEN the user has added a document as seen

THEN the user will see the document in the ‘Documents for review’ section

AND the user will see the document type with Review, ‘Accept document as seen’ and ‘Reject document as seen’ buttons",To Do,,yusuf.eldin,,23/Aug/23 8:03 PM,08/Sep/23 2:38 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7299,Three,,Story,"*As a* ERO viewing an application
*I want* to add notes
*So that* I can see and add notes to give greater context to decisions


----

h2. Technical Notes

We are suggesting this is the first part of the “notes” feature and is universally available to all parts of the application and filtered by meta data where a note is in a particular context.

POST /ero/{eroId}/application/{id}/notes - adding a new note (this ticket)
GET /ero/{eroId}/application/{id}/notes - get all notes on this application (would need another ticket if required - if not on GetById API)
PUT /ero/{eroId}/application/{id}/notes/{id} - If allowing edit (#7339)
DELETE /ero/{eroId}/application/{id}/notes/{id} - If allowing delete (#7441)

----

h2. Acceptance Criteria

h3. AC1: Add Qualifying Address Note

*Given* an *authorised user*
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database
*When* I call the *Add Notes API* sending note text and meta data
*Then* the application will have a new “note” added to the application with the supplied meta data
*And* the note will contain the following information:

||*Field*||*Value*||
|tags|Array of tags that allow the note to be associated to the qualifying address, or even to local attestation, or QA documents|
|note|The text entered by the ERO - field limit? (500?)|
|created by|The email address of the ERO that created the note|
|created date time|The date time the note was created|

h3. AC2: Qualifying Address Notes returned by GetById

*Given* an *authorised user*
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database
*When* I call the *Get Application By API*
*Then* the notes will be returned
{color:#ff5630}DISCUSS: should this be a NOTES API or part of the GETBYID?{color}

h3. AC3: Applications is Determined - (409) - {color:#ff5630}CAN YOU ADD NOTES AFTER AN APPLICATION HAS BEEN DETERMINED?{color}

h3. *AC4:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,24/Aug/23 2:17 PM,11/Sep/23 4:11 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7300,Three,,Story,"*As a* authorised user viewing the qualifying address details provided by the elector
*I want* to be able to add documents to the qualifying address determination
*So that* I can show evidence of approving and rejecting based on documents seen.

----

h2. Technical Notes

This is and extension / refinement API ticket [https://technologyprogramme.atlassian.net/browse/EIP1-7206|https://technologyprogramme.atlassian.net/browse/EIP1-7206|smart-link] 
The implementation could either be:

# An extension to the API above to add extra meta data to indicate the document is associated to the Qualifying Address and not the Identity check
## This could prove problematic if you need to restrict when documents can be updated (different statuses for different documents)
# A new API that adds the document with the required meta data
## This is probably the cleanest solution.
# Adding documents should have a new tag of “qualifying-address” and be returned in the qualifying address documents collection.

----

h2. Acceptance Criteria

The ACs are not written from a technical point of view as many of the API tickets are, as this process should following the same technical flow as 7206 and these ACs describe the expected behaviour

h3. AC1: Upload Qualifying Address Document

*Given* an ERO uploads a document to the qualifying address of an overseas application
*When* the documents has been uploaded to the application
*Then* the documents details will be returned as part of the GetById API within the qualifying address documents collection.
*And* the document can be retrieved from a pre-signed S3 URL

----

h3. Standard API ACs from here:

h3. AC1: Un-Authenticated (401)

h3. AC2: Unauthorised (403)

h3. AC3: Application not found (404)

h3. AC7: Invalid Application State (409) - Application determined or qualifying address determined.",To Do,,Krister Bone,,24/Aug/23 2:31 PM,12/Sep/23 12:18 AM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7301,Three,,Story,"As an ERO

I WANT to ensure that approvals and rejections that were send to IER will be passed on to EMS

So the EMS will have all approvals and rejections 



*Notes*:

This ticket is the second part of ensuring all approvals and rejections from the portal is sent to EMS via IER. See ticket for approvals and rejections send from SQS to IER [https://technologyprogramme.atlassian.net/browse/EIP1-5257|https://technologyprogramme.atlassian.net/browse/EIP1-5257|smart-link] 



*Tech Notes*

TBC

h3. Acceptance Criteria

GIVEN that the EROs have made final determinations

AND have sent to IER

WHEN IER receives the approvals or  rejection statuses

THEN these will need to be passed on to the EMS",To Do,,Krister Bone,,24/Aug/23 3:04 PM,11/Sep/23 4:12 PM,,,,EIP1-7302,,,,,,Beta|OAVA|OE|Refined|Valtech,,,,
EIP1-7309,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm I’ve seen document evidence on qualifying address information
*So that* I can approve residency for an overseas application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have seen documents to confirm an electors residency without having to upload the actual document.

h2. Requirements

* A document will be added to an application’s qualifying address list of documents. 
* No document will be uploaded, only the type of document will be supplied.
* The document will be added with the tag “qualifying-address” and this will be used to filter the document to the qualifying address document collection.

h2. Acceptance Criteria

h3. S1: Add Offline Document - (201 Happy Path)

*Given* the ERO user wants to indicate they have seen an offline document
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they add an offline-document
*Then* the the API will return a 201 response to indicate the request has been saved with the application
*And* the document info will be returned in the qualifying address document collection from the Get Application By Id with a channel of “offline”

h2. Error Scenarios

h3. S2: Invalid Request - (400)

*Given* the ERO user wants to indicate they have seen an offline document
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* a document type supplied is not defined in the supported list (doc type to be defined)
*Then* the the API will return a 400 Bad Request Response

h3. S3: Application’s Qual Address verification is Determined - (409)

h3. S4: The application has been Determined (409)

h3. *S5:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,24/Aug/23 4:28 PM,12/Sep/23 12:20 AM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7318,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my determination on an applicant’s documentary evidence 

so that I can process the application 

*Context*

Once all relevant checks has been made i.e. all attestation documents have been reviewed and an ERO has confirmed whether it is sufficient or not to confirm or not the validity of the relationship 

*Assumptions*

* attestation documents has been provided in support of the application and/or
* attestation documentation has been provided and uploaded

*Screen Design*

!image-20230901-200830.png|width=100%!

!image-20230901-200907.png|width=747,height=1103!



h3. Acceptance Criteria

*AC1: accept relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their parent/ guardian relationship 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time and ‘confirmed documentary evidence’ will be displayed 

AND confirmation will be recorded [https://technologyprogramme.atlassian.net/browse/EIP1-7358|https://technologyprogramme.atlassian.net/browse/EIP1-7358|smart-link] 

*AC2: reject relationship* 

Given that the authorised user is in qualifying address tab 

AND has reviewed the evidence provided by the applicant in support of their parent/ guardian relationship 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time and ‘cannot confirm documentary evidence’ will be displayed. 

AND confirmation will be recorded [https://technologyprogramme.atlassian.net/browse/EIP1-7358|https://technologyprogramme.atlassian.net/browse/EIP1-7358|smart-link] ",To Do,,yusuf.eldin,,24/Aug/23 6:33 PM,08/Sep/23 2:39 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7320,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to reject documents added as seen in support of an application

So that I can process this application

*Context*

When an applicant is applying under previous registration the ERO will see the following screen, and can check the applicant’s evidence 

This ticket will cover rejecting uploaded documents, and documents added as seen.

*Notes*

* Providing a rejection reason for a document is optional
* When other is selected as a rejection reason note field is mandatory 



*Screen Design*

!image-20230901-200609.png|width=100%!

*Reject document CTA*

!image-20230901-201604.png|width=917,height=244!



*Rejection reasons list* 

!reject1ion reasons list -20230817-121105.png|width=750,height=669!



*ACCEPTANCE CRITERIA*

*AC1 a: Reject uploaded document reason*

GIVEN that the authorised user is in the Identity Tab

AND is reviewing uploaded documents in the ‘Documents for review’ section

WHEN the user clicks the ‘Reject document’ button

THEN the UI will show the reject document reasons

AND a text box to add additional explanation for rejection

AND a Reject document and cancel button

 

*AC2a: Reject CTA*

GIVEN that the authorised user is rejecting a document under review

AND *selects rejection reasons*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection and a link to the document

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 



*AC2b: Reject with no reason selected*

 

GIVEN that the authorised user is rejecting a document under review

*AND does not select a rejection reason*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ERO name and date and time of rejection

AND *rejected reason* will show *‘not provided’*

AND the ‘Undo reject document’ button will be displayed

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] 

 

*AC2b: Reject CTA with additional information*

 

GIVEN that the authorised user is rejecting a document under review

*AND adds additional information*

WHEN the user rejects a document by clicking on the reject document button

THEN the rejected document will appear in Rejected document section

AND the document will show ‘Rejected reason’, ERO name and date and time of rejection

AND an extra field *‘additional information’ will show below.*

AND the document status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7340|https://technologyprogramme.atlassian.net/browse/EIP1-7340|smart-link] ",To Do,,yusuf.eldin,,24/Aug/23 6:34 PM,08/Sep/23 2:39 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7321,Three,,Story,"As an authorised user reviewing applications 

I WANT to be able to view uploaded documents 

So that I can process the evidence provided in support of submitted applications 

*Context*

When documents are uploaded as part of the application process by an applicant, or by an ERO during the review of an application. This ticket will cover the ability to view the documents that have been submitted as part of the application assessment. 

*Designs*

!image-20230830-143102.png|width=571,height=156!



AC1: Review Document

GIVEN that the user has navigated to an uploaded document in the document for review or the accepted/ rejected section 

WHEN the user has clicked on the Review  Document button or the document link 

THEN a document viewer will load the document in read-only mode",To Do,,yusuf.eldin,,24/Aug/23 6:34 PM,07/Sep/23 12:12 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7322,Three,,Story,"As an authorised user reviewing identity documents

I WANT to be able to view uploaded supporting documents

So that I can process the identity of the applicant

*Context*

When an attestation document has been uploaded by an applicant during the application process, or by an ERO when reviewing an application, these documents can be opened/ reviewed in the ‘documents for review’ section of the Qualifying address tab  

*Notes*

Attestation flow is applicable to all Overseas application routes including under 18 leaver, registration and residency the UI will remain the same for all routes however the page title will change dependent upon the application type 



*Designs*

!image-20230830-152305.png|width=1020,height=280!



AC1: Review Document

GIVEN that the user has navigated to an uploaded document in the document for review or the accepted/ rejected section 

WHEN the user has clicked on the Review  Document button or the document link 

THEN a document viewer will load the document in read-only mode",To Do,,yusuf.eldin,,24/Aug/23 6:34 PM,01/Sep/23 9:25 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7323,Three,,Story,"AS an ERO admin 

I want to edit the an applicant’s details when processing a residency application 

So that I can update incorrect details to process the application correctly 

*Background*  

This ticket will cover the basic structure of the page for the edit application details section for overseas elector residency applications. 



!image-20230825-160710.png|width=644,height=940!

!image-20230825-160811.png|width=100%!

*AC1* 

Given an ERO admin reviewing a residency application 

When they enter the ‘application details’ tab 

THEN they should see the data provided as part of the selected application (see designs)

AND change links for each provided data point should be provided on the page ",To Do,,yusuf.eldin,,24/Aug/23 6:38 PM,12/Sep/23 12:26 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7324,Three,,Story,"AS an ERO admin 

I want to edit the an applicant’s details when processing a residency application 

So that I can update incorrect details to process the application correctly 

h3. *Background*  

This ticket will cover the basic structure of the page for the edit application details section for overseas elector residency applications. 

h3. *Screens* 

!image-20230911-232126.png|width=647,height=917!

!image-20230911-232159.png|width=650,height=576!

*AC1* 

Given an ERO admin reviewing a registration application 

When they enter the ‘application details’ tab 

THEN they should see the data provided as part of the selected application (see designs)

AND change links for each provided data point should be provided on the page ",To Do,,yusuf.eldin,,24/Aug/23 6:38 PM,12/Sep/23 12:26 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7325,Three,,Story,"AS an ERO admin 

I want to edit the an applicant’s details 

So that I can update incorrect details to process the application correctly  

*Background* 

This ticket will cover the landing page for editing application details on a under 18 leaver’s application 

*Screens* 

!image-20230825-160610.png|width=592,height=1130!

*AC1* 

Given an ERO admin reviewing an under 18’s  application 

When they enter the ‘application details’ tab 

THEN they should see the data provided as part of the selected application (see designs)

AND change links for each provided data point should be provided on the page ",To Do,,yusuf.eldin,,24/Aug/23 6:38 PM,12/Sep/23 12:27 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7326,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm I’ve matched local data for qualifying address information
*So that* I can approve / reject residency for an overseas application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have seen local data evidence to confirm an electors residency.
This is a sub determination as part of either a under 18 or residency qualifying address check


h2. Acceptance Criteria

h3. S1: Set Local Address Match Status - (201 Happy Path)

*Given* an ERO wants to indicate they have seen local data verifying or rejecting an electors residency or under 18 registration eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set local data match service API to set the status to approved or rejected
*Then* the API will return a 201 response to indicate local data match status has been set to approved or rejected
*And* the local data match status will be returned as part of the qualifying address from the Get Application By Id

h2. Error Scenarios

h3. S4: Application’s Qual Address verification is Determined - (409)

h3. S5: The application has been Determined (409)

h3. *S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,24/Aug/23 9:53 PM,08/Sep/23 2:33 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7327,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm an attestation for qualifying address information
*So that* I can approve / reject residency for an overseas application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have confirmed an electors residency by attestation.
This is a sub determination as part of either a under 18 or residency qualifying address check.

h2. Acceptance Criteria

h3. S1: Set Attestation Status - (201 Happy Path)

*Given* an ERO wants to indicate they have approved or rejected an elector's attestation to determine their residency or under 18 eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set attestation status service API to set the status to approved or rejected
*Then* the API will return a 201 response to attestation status has been set to approved or rejected
*And* the attestation status will be returned as part of the qualifying address from the Get Application By Id

h2. Error Scenarios

h3. S4: Application’s Qual Address verification is Determined - (409)

h3. S5: The application has been Determined (409)

h3. *S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,25/Aug/23 10:34 AM,08/Sep/23 2:38 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7329,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run register checks against an applicant’s details 

So that I can determine if an applicant is eligible to vote based on their previous registration status  

*Note* 

For applicant’s who are confirmed as already having a current registration by the franchise code returned during the electoral register check, making this designation will count as a rejection of the previous registration section. 

{color:#ff5630}Confirmation needed on how to handle displaying current overseas elector registration for {color}

* {color:#ff5630}multiple matches {color}

*Screen Designs*

!image-20230906-145550.png|width=816,height=1110!



!image-20230825-182127.png|width=586,height=1035!



h2. Acceptance Criteria

*AC1: Confirm register check* 

Given an authorised user has ran a register check against an applicant’s details 

AND has reviewed the results 

WHEN they click ‘confirm previous registration’ 

THEN the qualifying address status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] 

AND a confirmation banner will show, with confirmed by ERO name, date and time 



*AC1: Reject register check* 

Given an authorised user has run a register check against an applicant’s details 

AND has reviewed the results 

WHEN they click ‘cannot confirm previous registration’ 

THEN the qualifying address status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] 

AND a confirmation banner will show, with rejected by ERO name, date and time 



*AC1: already registered as an overseas elector* 

Given an authorised user has run a register check against an applicant’s details 

AND their current registration has been confirmed 

WHEN they click ‘already registered as an overseas elector' 

THEN the qualifying address status will be updated [https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] 

AND a confirmation banner will show, with rejected by ERO name, date and time ",To Do,,yusuf.eldin,,25/Aug/23 7:19 PM,08/Sep/23 2:49 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7330,Three,,Story,"As an authorised user in the qualifying address tab

I WANT to be able to run register checks against an applicant’s details 

So that I can determine if an applicant is eligible to vote based on their previous registration status  

*Background* 

Once an ERO has checked the paper voter registration records they can manually verify within the paper registration record tab. 

*Screen Designs*

!image-20230825-182338.png|width=100%!

!image-20230825-182427.png|width=687,height=1097!



h2. Acceptance Criteria

*AC1: Confirm paper registration check* 

Given an authorised user is in the qualifying address tab 

WHEN they visit the paper register checks section 

THEN the UI should display the details provided in the application (see screen design)



*AC2: Confirm paper registration check* 

Given that the authorised user is in qualifying address tab 

AND has confirmed that the paper electoral register matches the details provided in the application 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with text confirmation message, ERO email and date and time of confirmation will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] 



*AC3: reject paper registration check* 

Given that the authorised user is in qualifying address tab 

AND has not found a match between the paper electoral register and  the details provided in the application 

WHEN the user clicks on the Confirm relationship button 

THEN a banner with rejection message, ERO email and date and time of rejection will be displayed

AND confirmation will be recorded{color:#ff5630} {color}[https://technologyprogramme.atlassian.net/browse/EIP1-7335|https://technologyprogramme.atlassian.net/browse/EIP1-7335|smart-link] ",To Do,,yusuf.eldin,,25/Aug/23 7:22 PM,08/Sep/23 2:50 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7331,Three,,Story,"*As an* authorised user viewing an application based on previous residence
*I want* to be DWP address checks to happen automatically when an application is received
*So that* I can process applications as quickly as possible.

h2. Technical Notes

When an application is received and has the flag “{{previouslyRegisteredOverseas""}} then a DWP historical address check should be automatically sent to the EROP DWP service.

h2. Acceptance Criteria

h3. AC1: Queue DWP Address Check

*Given* an application is received
*When* the application is flagged as a “{{previouslyRegisteredOverseas""}}
*Then* an SQS message will be sent to the EROP DWP service requesting a DWP historical address check
*And* the application will be saved indicating that the DWP check has been requested

h3. AC2: DWP Response Received

*Given* an application has requested a DWP historical address check
*When* the EROP DWP service processes the request and receives a response from DWP
*Then* the response will update the application with the status returned (MATCH / NO-MATCH)

h3. AC2: DWP Match Response Received

*Given* an application has requested a DWP historical address check
*When* the EROP DWP service processes the request and receives a response from DWP
*And* the response will update the application with the status returned of MATCH 
*Then* the qualifying address status will be automatically set to approved

h3. AC4: DWP No-Match - Automate Register Check?

*Given* an application has requested a DWP historical address check
*When* the EROP DWP service processes the request and receives a response from DWP
*And* the response has updated the application with the status returned of NO-MATCH)
*Then* the service will start an automated register check for the elector, or the electors guardian (the same individual used for the DWP check).
",To Do,,Krister Bone,,28/Aug/23 10:16 PM,11/Sep/23 10:05 AM,,,,EIP1-7231,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7332,Three,,Story,"*As an* ERO reviewing applications for under 18s
*I want* the register check to request EMSs to check historical registers of parents
*So that* I can find the electors parents who are no longer on current registers

----

h2. Assumption

{color:#bf2600}May not have parent / guardian details on application creation - or only on paper? or on edit?{color}



----

h2. Acceptance Criteria

h3. AC1: Queue Register Check

*Given* an application is received or edited
*When* the application is an Under 18 application
*Then* an SQS message will be sent to the EROP Register Checker service requesting a EMS register check for the applicants parent / guardian
*And* the application will be saved indicating that the register check has been requested for the elector’s parent

h3. AC2: EMS Response Received

*Given* an application has requested a register check
*When* the EROP register check service processes the a response from the EMS and sends a SQS message back to the OE API service
*Then* the response will update the application with the status returned.",To Do,,Krister Bone,,28/Aug/23 11:32 PM,11/Sep/23 4:13 PM,,,,EIP1-5175,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7333,One,,Story,"*As an* ERO in the overseas application
*I WANT* to be able to assign an application to an ERO (email address)
*So that* the application is allocated to that ERO

*Context*

EROs have the ability to assign cases to an ERO via their email address. This is selected from the assigned to dropdown from the UI.

See below:

!image-20230602-111247.png|width=773,height=238!

The list of email address in the dropdown will be the EROs with the permissions to access the Overseas Vote application.

Assignment rules:

# EROs can assign unassigned cases to themselves
# ERO can Unassign an application already assigned
# ERO can assign an already assigned application to someone else
# All applications default assignee will be ‘Unassigned’ if new

There is already the same functionality done in VAC that can be leveraged

*Tech Notes*

{{@PutMapping(""{applicationId}/assignee"")}}

* not-found if application not found

h2. Acceptance Criteria

*AC1*

*Given* a overseas vote application
*When* the API is called to update the assignee
*Then* the assignee is successfully updated

*AC2*

*Given* a overseas vote application
*When* the API is called to update the assignee for a non existing application id
*Then* the api responds with 404

AC3: 

*Given* a overseas vote application
*When* the API is called to update the assignee
*And* the assignee does not exist
*Then* the api will not validate the existence of the assignee 
*And* the api will return Http 202?",To Do,,Krister Bone,,28/Aug/23 11:58 PM,11/Sep/23 12:35 PM,,,,EIP1-5374,,3.0,,,,API|Beta|OAVA|Refined|Valtech,,,,
EIP1-7334,One,,Story,"COPIED - NOT WORKED ON YET UNTIL MODEL COMPLETED

*As a* overseas-admin processing an incomplete or incorrect application
*In order* to complete the application
*I want* to be able to update the application details

----

h2. Context

We do not yet provide the ability to modify an elector’s details which means certain checks (e.g. NINo) may have failed due to incorrect values. This story provides an API endpoint to update the elector’s details (name, address etc).

The complexity of this story is where a determination has been made based of the values changing and checks need to be re-run / re-queued. 

----

h2. Assumptions

* The same field validation rules that are used when creating a manual application are applied here (at both the API and UI).
* It will only be possible to modify applications not in a final determined status.
** Can only edit applications in statuses On Hold, To Do & In Progress
* It will be possible to update the values in the table below. 
* Editing these values will only affect the NINo check status, identity verification status and qualifying address statuses and nothing else (e.g. signature check if needed).

----

h2. Data

h3. Application Table

||*Field*||*Notes*||
|gssCode|If ERO selects a different LA within the current ERO|
|nino|If updated, will initiate a new DWP check|
|channel|Can only be updated if paper or in-person.|
|dateTimeReceived| |
|applicationDate| |
|submittedInWelsh| |
|applicant.firstName|If updated, will initiate a new DWP check|
|applicant.middleNames| |
|applicant.surname|If updated, will initiate a new DWP check|
|applicant.address|If updated, will initiate a new DWP check|
|applicant.dateOfBirth|If updated, will initiate a new DWP check|
|applicant.registeredWithUnknownDob| |
|applicant.unknownDobReason| |
|applicant.ageRange| |
|applicant.phoneNumber|Will impact register check|
|applicant.emailAddress|Will impact register check|
|applicant.proxyFirstName| |
|applicant.proxyMiddleNames| |
|applicant.proxySurname| |
|applicant.proxyEmail| |
|applicant.proxyPhoneNumber| |
|applicant.proxyAddress| |
|proxyVoteDetails.proxyVoteType| |
|proxyVoteDetails.proxyVoteDate| |
|proxyVoteDetails.proxyVoteFrom| |
|proxyVoteDetails.proxyVoteTo| |
|{color:#bf2600}*proxyVoteDetails.proxyVoteReason*{color}|{color:#bf2600}*CANNOT EDIT*{color}|
|proxyVoteDetails.disabilityInfo.reasonType| |
|proxyVoteDetails.disabilityInfo.reasonTxt| |
|proxyVoteDetails.disabilityInfo.disabilityEndDate| |
|proxyVoteDetails.disabilityInfo.detainmentProvision| |
|proxyVoteDetails.disabilityInfo.supporter|See Supporter Table|
|proxyVoteDetails.educationInfo.attendeeType| |
|proxyVoteDetails.educationInfo.reasonTxt| |
|proxyVoteDetails.educationInfo.establishmentName| |
|proxyVoteDetails.educationInfo.courseName| |
|proxyVoteDetails.educationInfo.partnerName| |
|proxyVoteDetails.educationInfo.dateFrom| |
|proxyVoteDetails.educationInfo.dateTo| |
|proxyVoteDetails.educationInfo.supporter|See Supporter Table|
|proxyVoteDetails.employmentInfo.partnerName| |
|proxyVoteDetails.employmentInfo.employerName| |
|proxyVoteDetails.employmentInfo.employerAddress| |
|proxyVoteDetails.employmentInfo.jobTitle| |
|proxyVoteDetails.employmentInfo.reasonType| |
|proxyVoteDetails.employmentInfo.reasonTxt| |
|proxyVoteDetails.employmentInfo.supporter|See Supporter Table|

h3. Qualifying Address Info

||*Field*||*Notes*||
|supporter.firstName| |
|supporter.middleNames| |
|supporter.surname| |
|supporter.email| |
|supporter.phoneNumber| |
|supporter.address| |
|supporter.position| |
|supporter.qualification| |
|supporter.ageRange| |
|supporter.signatureDate| |

h2. Acceptance Criteria

* Are the elector’s details updated successfully?
* Is the Register check re-run if any of these fields are updated?: GssCode, DoB, phoneNumber, email, elector’s name or address AND the register status is set back to defaults
* Is the Nino check re-run if either of these fields are updated?: nino, DoB AND the identity check and NINo check status are set back to defaults
* If Dob is removed: 
** Is the register check status set to PENDING in the DB? 
** Is the NINo check status set to INSUFFICIENT_DATA in the DB? 
** Is {{registerStatus}} set to {{pending}} in the application summary response?
** Is {{identityVerificationStatus}} set to {{not-verified}} in the application summary response?  
** Is the most recent {{registerCheck}} returned with a status of {{pending}} in the application by ID response?
** Is {{ninoCheck}} returned with a status of {{insufficient-data}} in the application by ID response?

h2. Scenarios 

*S1 - Update NINo*
*Given* a proxy vote application
*And* the elector's identity has been verified
*And* the elector is confirmed as being on the electoral register
*When* the API is called to update the elector's NINo
*Then* the NINo is successfully updated
*And* the {{identityVerificationStatus}} is set to {{not-verified}} in the application summary response (immediately after the update)
*And* {{ninoCheck}} is set to {{not-checked}} in the application by ID response (immediately after the update)
*And* a new DWP check is initiated

*S2 - Update elector’s name or address*
*Given* a proxy vote application
*And* the elector's identity has been verified
*And* the elector is confirmed as being on the electoral register
*When* the API is called to update the elector's name or address
*Then* the values are successfully updated
*And* the {{registerStatus}} is set to {{pending}} in the application summary response (immediately after the update)
*And* {{registerCheck}} is set to {{pending}} in the application by ID response (immediately after the update)
*And* a new register check is initiated

*S3 - Update DoB*
*Given* a proxy vote application
*And* the elector's identity has been verified
*And* the elector is confirmed as being on the electoral register
*When* the API is called to update the elector's DoB
*Then* the DoB is successfully updated
*And* {{registerStatus}} is set to {{pending}} in the application summary response
*And* {{identityVerificationStatus}} is set to {{not-verified}} in the application summary response?
*And* {{registerCheck}} is set to {{pending}} in the application by ID response
*And* {{ninoCheck}} is set to {{not-checked}} in the application by ID response
*And* a new DWP check is initiated
*And* a new register check is initiated

*S4 - Remove DoB (required for NINo check but not register check)*
*Given* a proxy vote application
*And* the elector's identity has been verified
*And* the elector is confirmed as being on the electoral register
*When* the API is called to remove the elector's DoB
*Then* the DoB is removed from the application
*And* {{registerStatus}} is set to {{pending (insufficient-data)}} in the application summary response
*And* {{identityVerificationStatus}} is set to {{not-verified}} in the application summary response?
*And* {{registerCheck}} is set to {{pending}} in the application by ID response
*And* {{ninoCheck}} is set to {{insufficient-data}} in the application by ID response
*And* a new register check is initiated

*S5 - Remove NINo (Discussed with Krister and will be refined into further story)*
*Given* a proxy vote application
*And* the elector's identity has been verified
*And* the the ERO wishes to remove the elector’s NINo
*And* the ERO has provided a reason for not providing the NINo
*When* the API is called to remove the elector's NINo
*Then* the NINo is removed from the application
*And* identityVerificationStatus is set to not-verified in the application summary response?
*And* ninoCheck is set to insufficient-data in the application by ID response

{color:#ff5630}REASON NOT REQUIRED BY ERO{color}

*S6 - Remove NINo without giving reason (Discussed with Krister and will be refined into further story)*

*S7 - Remove phone number or email (noContact changed) - will impact register checks : pass*

*S8 - Update channel from paper to in-person : valid*

*S9 - Cannot update channel or dateReceived when digital application (digital->post, digital->in-person): should error - 409 conflict : pass (see attached screenshot)*

*S10 - Update gssCode (when there is more than one gssCode for a local authority) -pass (tested with lothian-vjb ERO’s)*

*S11 - Update submitted language: no auto run checks for this change : Pass*

*S12 - Cannot change proxyVoteDetails.proxyVoteReason : not part of the payload so cannot change this*

(Other “standard” scenarios such as 401, 403 and 404 etc not listed)",To Do,,Krister Bone,,29/Aug/23 10:19 AM,12/Sep/23 1:04 AM,,,,EIP1-4886,,,,,,API|Beta|OE|RefineInProgress|Valtech,,,,
EIP1-7335,Three,,Story,"*As an* ERO processing an overseas application
*I want* to approve or reject the register check status of the elector or their parent/guardian
*So that* I can determine the application

----

h2. Context

There are 2 routes where an ERO can approve and reject register checks:

# The elector’s register check
# The elector’s parent / guardian register check

Follows the same pattern as OAVA API:
PUT '/eros/{eroId}/applications/{applicationId}/register-status'

Rejected Reasons need finalised.

----

h2. Acceptance Criteria

h3. AC1: Set Approved Register Determination Status - (201 Happy Path)

*Given* an ERO wants to indicate they have approved an elector or the elector’s parent / guardian’s presence on a register to determine their registration or their under 18 eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set register status service API to set the status to approved
*And* they have supplied the selected match from the register check (optional?)
*Then* the API will return a 201 response
*And* the qualifying register check determination status will be set to approved
*And* the ems elector Id will be set to the ems elector id supplied (optional?)
*And* the register check determination status will be returned as part of the qualifying address from the Get Application By Id

h3. AC2: Set Rejected Register Determination Status - (201 Happy Path)

*Given* an ERO wants to indicate they have rejected an elector or the elector’s parent / guardian’s presence on a register to determine their registration or their under 18 eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set register status service API to set the status to rejected
*And* they have supplied the reason for rejecting the register check
*Then* the API will return a 201 response
*And* the qualifying register check determination status will be set to rejected
*And* the register check determination reason will be set to reason supplied
*And* the register check determination status will be returned as part of the qualifying address from the Get Application By Id

h3. AC3: Set Rejected Register Determination Status - (400 Un-Happy Path - no reason supplied)

*Given* an ERO wants to indicate they have rejected an elector or the elector’s parent / guardian’s presence on a register to determine their registration or their under 18 eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set register determination status service API to set the status to approved
*And* they do not supply a reason for the rejection
*Then* the API will return a 400 response

h2. Error Scenarios

h3. AC4: Application’s Qual Address verification is Determined - (409)

h3. AC5: The application has been Determined (409)

h3. *AC6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,29/Aug/23 11:45 AM,08/Sep/23 2:50 PM,,,,EIP1-7230,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7336,Three,,Story,"*As an* ERO processing an overseas application
*I want* to approve or reject the residency check status of the elector or their parent/guardian
*So that* I can determine the application

----

h2. Context

Suggesting to follows the same pattern as OAVA and Register Check API (could add qualifying-address to path):
PUT '/eros/{eroId}/applications/{applicationId}/residency-status'

----

h2. Acceptance Criteria

h3. AC1: Set Residency Determination Status - Approved / Rejected / Not-Checked (undo) (201 Happy Path)

*Given* an ERO wants to indicate they have approved / reject / undo an elector or the elector’s parent / guardian’s residency check
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set residency status service API to set the status to approved / rejected / not-checked
*Then* the API will return a 201 response
*And* the qualifying address residency status will be set to approved / rejected / not-checked
*And* the residency check status will be returned as part of the qualifying address from the Get Application By Id

h2. Error Scenarios

h3. AC2: Application’s Qual Address verification is Determined - (409)

h3. AC3: The application has been Determined (409)

h3. *AC4:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,29/Aug/23 11:48 AM,06/Sep/23 4:41 PM,,,,EIP1-7231,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7339,Three,,Story,"*As an* ERO
*I want* to be able to edit a note I’ve previously written
*So that* I can fix any errors make in original


----

h2. Technical Notes

* Audit tables to save history of changes
* Can only edit own notes?
* Can’t edit meta data of notes?
* PUT /ero/{eroId}/application/{id}/notes/{id}

----

h2. Acceptance Criteria

h3. AC1: Edit Note

*Given* an *authorised user*
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database
*When* I call the *Edit Notes API* sending updated text
*Then* the application note will be updated
*And* the history of the note changes will be stored in an audit table

h3. AC2: Applications is Determined - (409) - {color:#ff5630}CAN YOU EDIT NOTES AFTER AN APPLICATION HAS BEEN DETERMINED?{color}

h3. *AC3:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,29/Aug/23 12:17 PM,11/Sep/23 4:14 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7340,Three,,Story,"*As a* overseas-admin processing an application
*I want* to set the status on documentary evidence supplied on qualifying address information
*So that* I can mark a document as rejected, or undo a previously rejected document
*And so that* I can approve, reject and send further communication to the elector to request further documentary evidence

----

h2. Technical Notes

Suggesting this as an extension to the PATCH {{/eros/{eroId}/applications/{applicationId}/documents/{documentId}}} API - which now needs to:

# Use tags to ensure the correct business rules apply
## Documents with the “identity” tag can not be updated if the identity determination has been completed.
## Documents with the “qualifying-address” tag can not be updated if the qualifying address determination has been completed. 

h2. Acceptance Criteria

h3. AC1: Set Qualifying address Document Status

*Given* an overseas application document
*And* the document has the “qualifying-address” tag
*And* the qualifying address status has not been determined
*When* the document status API is called to update the documents status  (plus reasons for rejected)
*Then* the documents status will be updated to reflect the status provided (not-checked, accepted, rejected)
*And* if rejected, the rejected reasons will be updated

h3. AC1: Set Identity Document Status

*Given* an overseas application document
*And* the document has the “identity” tag
*And* the the identity status has not been determined
*When* the document status API is called to update the documents status (plus reasons for rejected)
*Then* the documents status will be updated to reflect the status provided (not-checked, accepted, rejected)
*And* if rejected, the rejected reasons will be updated

h2. Error Scenarios

As existing implementation",To Do,,Krister Bone,,29/Aug/23 1:40 PM,12/Sep/23 12:30 AM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7358,Three,,Story,"*As a* overseas-admin processing an application
*I want* to confirm documentary evidence for qualifying address information
*So that* I can approve residency for an overseas application

h2. Context

The focus of this story is to enable the {{overseas-admin}} to indicate they have confirmed an electors residency by documentary evidence 
This is a sub determination as part of either a under 18 or residency qualifying address check.

h2. Acceptance Criteria

h3. S1: Set Documentary Evidence Status - (201 Happy Path)

*Given* an ERO wants to indicate they have approved or rejected an elector's documentary evidence to determine their residency or under 18 eligibility
*And* the application has not been determined (including in-progress)
*And* the qualifying address has not been confirmed
*When* they call the set documentary evidence status service API to set the status to approved or rejected
*Then* the API will return a 201 response to documentary evidence status has been set to approved or rejected
*And* the documentary evidence status will be returned as part of the qualifying address from the Get Application By Id

h2. Error Scenarios

h3. S4: Application’s Qual Address verification is Determined - (409)

h3. S5: The application has been Determined (409)

h3. *S6:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,30/Aug/23 11:58 PM,08/Sep/23 2:39 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7411,Three,,Story,"*As an* ERO
*I want* to be able to delete a note I’ve previously written
*So that* I can remove comments I n o longer want associated to the application

----

h2. Technical Notes

* Audit tables to save history of changes
* Can only delete own notes?
* DELETE /ero/{eroId}/application/{id}/notes/{id}

----

h2. Acceptance Criteria

h3. AC1: Delete Note

*Given* an *authorised user*
*And* a overseas application with the {applicationId} for the current user's ERO is present in the database
*When* I call the *Delete Notes API*
*Then* the application note will be removed from the application
*And* the history of the note deletion will be stored in an audit table

h3. AC2: Applications is Determined - (409) - {color:#ff5630}CAN YOU DELETE NOTES AFTER AN APPLICATION HAS BEEN DETERMINED?{color}

h3. *AC3:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,04/Sep/23 2:41 PM,11/Sep/23 4:15 PM,,,,EIP1-4494,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7414,Three,,Story,"*As an* ERO administrator processing applications 

*I want* to only be presented with actions that are relevant to the determination state of an application  

*So that* I can avoid erroneous updates to determined applications 

*Notes*

{color:#ff5630}Confirmation required on whether Notes feature will be disabled upon determination {color}

*Background* 

This ticket will cover the modification of several CTA’s with the Qualifying address journey that will need to be modified. e.g. hidden or disabled, once an application has been determined. 

This is to prevent erroneous actions on applications post determination 

* Check register button (prior registration page)
* Determination buttons for the following sections are removed 
** Automatic Register checks 
** Paper register checks 
** Proof of parent/ guardian relationship 
** Previous residency
** Local data match 
** Documentary evidence 
** Attestation 
* Qualifying address determination section is removed from the task list 
* Uploading or adding new qualifying address documents, ‘add document section should be removed from the following sections 
** Proof of parent/ guardian relationship 
** Documentary evidence 
** Attestation 
* Updates to uploaded documents e.g. rejection, or requesting new. documents buttons are removed.
* Review button and links for uploaded and offline documents remain functional  
* Change links for parent/guardian details.
* Change links for Last known UK address (previous residency page) ",To Do,,yusuf.eldin,,04/Sep/23 9:54 PM,08/Sep/23 2:41 PM,,,,EIP1-4494,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7415,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my progress in actions taken to verify an under 18 leaver’s right to vote 

so that I can process the application 

*Context*

*Screen designs*

!image-20230817-171851.png|width=552,height=997!

h2. *Acceptance Criteria*

*Upload Document*

*AC1: Proof of relationship not complete* 

Given an authorised user is processing an application

When a determination has not yet been made on the proof of relationship section  

THEN all other task-list sections should show ‘cannot start yet’ 

And the determination buttons ‘confirm' & ‘reject’ qualifying address are disabled. 



*AC2: Proof of relationship confirmed*

Given an authorised user is processing an application

When the proof of relationship has been confirmed  

THEN all other task-list sections should show ‘not required’ 

AND the button ‘confirm qualifying address’ becomes operational 



*AC3: Proof of relationship not confirmed* 

Given an authorised user is processing an application

When the proof of relationship has been confirmed   

 THEN the status of all other task list sections should update to ‘incomplete’

AND the button ‘Reject qualifying address’ becomes operational 



*AC4.* 

Given an authorised user is processing an application

WHEN any task list section has been confirmed 

Then all other sections should show ‘not required’ 

AND the button ‘confirm qualifying address’ becomes operational 



*AC5 confirm qualifying address* 

Given an authorised user has confirmed proof or relationship 

AND has confirmed any other qualifying address task list sections 

AND has made a determination of ‘confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to confirmed 



*AC5 reject qualifying address* 

Given an authorised user has confirmed or rejected proof of parent/guardian relationship

AND has rejected any of the qualifying address task list sections 

AND has made a determination of ‘cannot confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to rejected ",To Do,,yusuf.eldin,,04/Sep/23 11:22 PM,06/Sep/23 9:40 PM,,,,EIP1-5175,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7426,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my progress in actions taken to verify an applicant’s right to vote  

so that I can process the application 

*Context*

*Screen designs*

!image-20230825-162101.png|width=532,height=891!



h2. *Acceptance Criteria*

*Upload Document*

*AC1: Registration not complete* 

Given an authorised user is processing an application

When a determination has not yet been made on the automatic or paper registration checks sections

THEN all other task-list sections should show ‘cannot start yet’ 

AND the links to these sections are disabled 

And the determination buttons ‘confirm' & ‘reject’ qualifying address are disabled. 



*AC2: Registration confirmed*

GIVEN an authorised user is processing an application

WHEN the automatic or paper registration checks sections have been confirmed 

THEN all other task-list sections should show ‘not required’ 

AND the determination button ‘confirm qualifying address’ becomes operational 



*AC3: Registration rejected* 

Given an authorised user is processing an application

When the automatic and paper registration checks have been rejected   

THEN the status of all other task list sections should update to ‘incomplete’

AND the links to these sections are enabled

AND the determination button ‘Reject qualifying address’ becomes operational 



*AC4.* 

Given an authorised user is processing an application

AND automatic and paper registration checks have been rejected 

WHEN any other task list section has been confirmed  

Then all other sections should show ‘not required’ 

AND the button ‘confirm qualifying address’ becomes operational 



*AC5 confirm qualifying address* 

Given an authorised user has confirmed any of the qualifying address task list sections 

AND has made a determination of ‘confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to confirmed 



*AC5 reject qualifying address* 

Given an authorised user has rejected any of the qualifying address task list sections 

AND has made a determination of ‘cannot confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to rejected ",To Do,,yusuf.eldin,,05/Sep/23 5:40 PM,11/Sep/23 10:00 PM,,,,EIP1-7230,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7427,Three,,Story,"As an authorised user in the qualifying address tab 

I WANT to be able to record my progress in actions taken to verify an applicant’s right to vote 

so that I can process the application 

*Context*

*Screen designs*

!image-20230905-172915.png|width=786,height=1144!



h2. *Acceptance Criteria*

*Upload Document*

*AC1: Residency checks not complete* 

Given an authorised user is processing an application

When a determination has not yet been made on the residency checks sections

THEN all other task-list sections should show ‘cannot start yet’ 

AND the links to these sections are disabled 

And the determination buttons ‘confirm' & ‘reject’ qualifying address are disabled. 



*AC2: Registration confirmed*

GIVEN an authorised user is processing an application

WHEN the residency checks sections have been confirmed 

THEN all other task-list sections should show ‘not required’ 

AND the determination button ‘confirm qualifying address’ becomes operational 



*AC3: Residency checks rejected* 

Given an authorised user is processing an application

When the automatic and paper residency checks have been rejected   

THEN the status of all other task list sections should update to ‘incomplete’

AND the links to these sections are enabled

AND the determination button ‘Reject qualifying address’ becomes operational 



*AC4.* 

Given an authorised user is processing an application

AND automatic and paper registration checks have been rejected 

WHEN any other task list section has been confirmed  

Then all other sections should show ‘not required’ 

AND the button ‘confirm qualifying address’ becomes operational 



*AC5 confirm qualifying address* 

Given an authorised user has confirmed any of the qualifying address task list sections 

AND has made a determination of ‘confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to confirmed 



*AC5 reject qualifying address* 

Given an authorised user has rejected any of the qualifying address task list sections 

AND has made a determination of ‘cannot confirm qualifying address’ 

THEN the qualifying address status is updated  [https://technologyprogramme.atlassian.net/browse/EIP1-7285|https://technologyprogramme.atlassian.net/browse/EIP1-7285|smart-link] 

AND the tab status will update from pending to rejected ",To Do,,yusuf.eldin,,05/Sep/23 5:41 PM,06/Sep/23 11:21 PM,,,,EIP1-7231,,,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7428,Three,,Story,"*As an* ERO processing applications 
*I want* to be able to request new register check requests from the EMS systems
*So that* EMS updates and emsIdentiferId requests can be re-processed.

----

h3. Context:

This Story is the implementation of the following API

# {{POST /eros/{eroId}/applications/{applicationId}/register-status}}
## Add the ability request a new register check
## Either re-check with existing elector details or parent guardian details or using the supplied emsElectorId
# This will also send the register check request to the register check service
## When sending with the emsElectorId - the register check service will ignore until it is refactored to support this

----

h2. Acceptance Criteria

h3. AC1: Accept Register Check Request Happy Path

*Given* an *authorised user* in the *overseas-admin* group for the *current ERO*
*And the* the overseas application exists in the *current ERO*
*When* I call the *POST /eros/{eroId}/applications/{applicationId}/register-status API*
*And* send an emsElectorId (optional)
*Then* the a new register check will be created
*And* a the new register check registerDetermination will be populated with the emsElectorId when provided (or null)
*And* a new register check request will be sent to the Register Check service containing all elector details or parent/guardians details and the emsElectorId when provided
*And* the register check status will be set to pending or pending-id-check


h3. Error Scenarios

h3. AC2: Application’s Qual Address verification is Determined - (409)

h3. AC3: The application has been Determined (409)

h3. *AC4:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,06/Sep/23 12:26 AM,08/Sep/23 1:21 PM,,,,EIP1-7230,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7429,Three,,Story,"*As an* ERO processing applications 
*I want* to be able to undo approved and rejected register determinations
*So that* I can correct any errors made

----

h2. Context:

This Story is the implementation of the following API

# {{PUT /eros/{eroId}/applications/{applicationId}/register-status/undo-determination}}
## Add the ability to revert and approved or rejected register determination.

----

h2. AC1: Undo Accept / Reject Register Determination Request Happy Path

*Given* an *authorised user* in the *overseas-admin* group for the *current ERO*
*And the* the overseas application exists in the *current ERO*
*And the* the register check registerDetermination is approved or rejected
*When* I call the *PUT /eros/{eroId}/applications/{applicationId}/register-status/undo-determination API*
*Then* the API will return a 201/4 response code.
*And* the registerDetermination status and rejected reasons will be cleared (set to null).

h2. Error Scenarios

h3. AC2: Application’s Qual Address verification is Determined - (409)

h3. AC3: The application has been Determined (409)

h3. *AC4:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,06/Sep/23 12:30 AM,11/Sep/23 12:21 PM,,,,EIP1-7230,,,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7435,Three,,Story,"*As an* ERO rejecting documents from the elector
*I want* to be able to preview and send communications to the elector
*So that* the elector knows to submit new documents to progress their application

----

h3. Technical Notes

APIs required:

# POST (channels - email or letter) /eros/{eroId}/applications/{applicationId}/comms/rejected-documents/{channel}/preview
# POST (channels - email or letter)  /eros/{eroId}/applications/{applicationId}/comms/rejected-documents/{channel}
# Consider Welsh

h3. Email Content - GOV.Notify Parameters

* Application Reference (applicationReference)
* First Name (firstName)
* Rejection Reason List (rejectionReasonList)
* Rejection Reason Text (rejectionReasonMessage)
* ERO Address
** eroAddressLine1
** eroAddressLine2
** eroAddressLine3
** eroAddressLine4
** eroPostcode
** eroPhone
** eroWebsite
** eroEmail
* LA Name (LAName)



h3. AC1: Preview Email - Has Email Address (Happy Path - 200)

*Given* the ERO has rejected documents
*And* the Elector has an email address
*And* the ERO wants to send rejected comms to the Elector
*When* the ERO requests to view a preview of the Email to be sent
*Then* the API will return the GOV.Notify Preview Email

h3. AC2: Preview Email - No Email Address (Un-Happy Path - 409)

*Given* the ERO has rejected documents
*And* the Elector doesn’t have an email address
*And* the ERO wants to send rejected comms to the Elector
*When* the ERO requests to view a preview of the Email to be sent
*Then* the API returns a 409 Conflict response

h3. AC3: Preview Letter - No Email Address (Happy Path - 200)

*Given* the ERO has rejected documents
*And* the Elector doesn’t have an email address
*And* the ERO wants to send rejected comms to the Elector
*When* the ERO requests to view a preview of the Letter to be sent
*Then* the API will return the GOV.Notify Preview Letter

h3. AC4: Preview Letter - Has Email Address (Un-Happy Path - 409)

*Given* the ERO has rejected documents
*And* the Elector has an email address
*And* the ERO wants to send rejected comms to the Elector
*When* the ERO requests to view a preview of the Letter to be sent
*Then* the API returns a 409 Conflict response

h3. AS ABOVE  x 4 - Replace Preview with SEND

h3. *AC X:* (i) (Plus the usual 401/403/404 etc)",To Do,,Krister Bone,,06/Sep/23 3:41 PM,08/Sep/23 2:52 PM,,,,EIP1-4308,,3.0,,,,API|Beta|OE|Refined|Valtech,,,,
EIP1-7439,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link] will be Done
* This story will deal with the creation of page 1 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=1-43&mode=design&t=mBpcRe9gJxXQqkDN-0|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=1-43&mode=design&t=mBpcRe9gJxXQqkDN-0|smart-link] 

Applications list page:

!image-20230906-203633.png|width=1508,height=509!

*AC1 page 1*

*Given* I want to create a OE application manually (from a paper/in person)

*When* I select the option to ‘Create new application’ on the applications list page 

*Then* I will be prompted to enter the information shown on page 1 (wireframe below)

*And* the following rules apply:

* No defaults except ‘Date/time received by’ time element which will be set to midnight
* selecting the ‘Set to today’s date and current time' option will change the default time element of ‘Date/time received by’ accordingly 

Page 1:

!image-20230906-203813.png|width=50%!

{color:#bf2600}*Note: As the working assumption is to not have signatures or waivers then any design elements relating to signatures and waivers are to be ignored*{color}



*AC2 Page 1 validation*

*Given* I have entered the information on Page 1

*And* I have broken any of the following rules:

* All fields are mandatory
* Date/time received cannot be in the future or more than 3 months in the past 

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 9:16 PM,11/Sep/23 12:48 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7440,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 2 of 14 pages
* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-19970&mode=design&t=mBpcRe9gJxXQqkDN-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-19970&mode=design&t=mBpcRe9gJxXQqkDN-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]

*AC1 Page 2*

*Given* I have selected the option to Continue on page 1

*Then* I will be prompted to enter the information shown on page 2 (wireframe below)

Page 2:

!image-20230906-204638.png|width=2271,height=5493!



*AC4 Page 2 validation*

*Given* I have entered the information on Page 2

*And* I have not provided information for these mandatory fields:

* First (given) name
* Last (family) name
* Current Address - Street
* Current address - Postcode

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 9:18 PM,11/Sep/23 12:48 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7441,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link] 



*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link] will be Done
* This story will deal with the creation of page 3 of 14 pages
* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-20819&mode=design&t=mBpcRe9gJxXQqkDN-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-20819&mode=design&t=mBpcRe9gJxXQqkDN-4|smart-link] 

*AC1 Page 2*

*Given* I have selected *Yes* to the *Applicant has moved in the past 12 months* question in *page 1*

 *AND* selected the option to Continue on page 2

*Then* I will be prompted to enter the information shown on page 3 (wireframe below)



Page 3:

!image-20230906-205556.png|width=2271,height=3171!



*AC4 Page 3 validation*

*Given* I have entered the information on Page 3

*And* I have not provided information for these mandatory fields:

* Prev address - Street
* Prev address - Postcode

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 9:20 PM,11/Sep/23 12:48 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7442,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 4 of 14 pages
* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21274&mode=design&t=mBpcRe9gJxXQqkDN-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21274&mode=design&t=mBpcRe9gJxXQqkDN-4|smart-link] 



*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]

*AC1 Page 2*

*Given* I have selected *YES* to *Name Change since last registered to vote question* on Page 1

*AND* selected the option to Continue on page 3

*Then* I will be prompted to enter the information shown on page 4 (wireframe below)

Page 4:

!image-20230906-211520.png|width=2271,height=2649!



*AC4 Page 4 validation*

*Given* I have entered the information on Page 4

*And* I have not provided information for these mandatory fields:

* Full previous name
* Reason for name change

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 9:24 PM,11/Sep/23 12:48 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7443,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 5 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21458&mode=design&t=mBpcRe9gJxXQqkDN-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21458&mode=design&t=mBpcRe9gJxXQqkDN-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]

*AC1 Page 5*

*Given* I have selected the option to Continue on page 2

*Then* I will be prompted to enter the information shown on page 5 (wireframe below)



!image-20230906-212756.png|width=2271,height=2649!

*AC2 Page  5 validation*

*Given* I have entered the information on Page 5

*And* I have broken any of the following rules:

* DOB cannot be in the future

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 9:27 PM,11/Sep/23 12:48 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7444,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 6 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21753&mode=design&t=mBpcRe9gJxXQqkDN-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=24-21753&mode=design&t=mBpcRe9gJxXQqkDN-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 6*

*Given* I have selected the option to Continue on page 5

*Then* I will be prompted to enter the information shown on page 6 (wireframe below)

!image-20230906-213237.png|width=1136,height=1324!

*AC2 Page  6 validation*

*Given* I have entered the information on Page 5

*And* I have broken any of the following rules:

* if NI number not provided then reasons must be entered

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,06/Sep/23 10:30 PM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7445,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 8 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=26-22462&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=26-22462&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 8*

*Given* I have selected the option to Continue on page 7

*Then* I will be prompted to enter the information shown on page 8(wireframe below)

!image-20230907-064305.png|width=2271,height=4316!

*AC2 Page 8 validation*

*Given* I have entered the information on Page 8

*And* I have broken any of the following rules:

* Street is mandatory
* Postcode is mandatory
* At least 1 radio button must be selected
* Any dates cannot be in the future
* If selected Applicant was too young to be registered to vote then Parent or guardian field cannot be empty
* If selected Applicant was too young to be registered to vote then Parent or guardian check box must have at least one checked

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 7:21 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7446,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 7 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=26-22278&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=26-22278&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 7*

*Given* I have selected the option to Continue on page 6

*Then* I will be prompted to enter the information shown on page 7 (wireframe below)

!image-20230907-064050.png|width=2271,height=2649!

*AC2 Page  7 validation*

*There are no validation rules as fields are optional*",To Do,,Shane.yin,,07/Sep/23 7:37 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7447,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 9 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23358&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23358&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 9*

*Given* I have selected *YES* to the *Too young to be registered to vote when applicant left the UK* question *from Page 1*

AND selected the option to Continue on page 8

*Then* I will be prompted to enter the information shown on page 9 (wireframe below)

!image-20230907-074150.png|width=2271,height=3993!

*AC2 Page 9 validation*

*Given* I have entered the information on Page 8

*And* I have broken any of the following rules:

* Only 1 check box *and* at least 1 must be ‘checked’ for Supporting documentation supplied
* if selected ‘*Yes*’ to *Supporting document supplied* question then at least 1 radio button must be selected for *Applicant current name different to supporting document* question
* if selected ‘*Yes*’ to *Applicant current name different to supporting document* question then previous full name and reason for changing must be mandatory
* if selected ‘*Yes*’ to *Supporting document supplied* question then at least 1 radio button must be selected for *Parent or guardian name different to document supplied or changed since last registered to vote* question
* if selected ‘*Yes*’ to *Parent or guardian name different to document supplied or changed since last registered to vote*  question then previous full name and reason for changing must be mandatory

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 8:38 AM,11/Sep/23 12:38 PM,,,,EIP1-5177,,3.0,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7448,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 10 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23718&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23718&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 10*

*Given* I have  selected the option to Continue on page 8

AND if *Too young to be registered to vote when applicant left the UK* condition was met then continue option from Page 9

*Then* I will be prompted to enter the information shown on page 10 (wireframe below)

!image-20230907-084203.png|width=2271,height=2860!

*AC2 Page 10 validation*

*Given* I have entered the information on Page 10

*And* I have broken any of the following rules:

* at least 1 option for Statement of previous registration must be checked
* If *Previously registered to vote as an overseas voter. (Not been registered to vote as a resident of the UK since then) until* option is selected then date must be entered and cannot be in the future

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 9:32 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7451,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 11 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23961&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-23961&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 11*

*Given* I have  selected the option to Continue on page 10

*Then* I will be prompted to enter the information shown on page 11 (wireframe below)

!image-20230907-091117.png|width=2271,height=3438!

*AC2 Page 11 validation*

*Given* I have entered the information on Page 10

*And* I have broken any of the following rules:

* at least 1 option for Citizenship must be checked
* Passport number is mandatory if relevant option was selected
* Passport - place of issue is mandatory if relevant option was selected
* dates are mandatory if relevant option was selected
* how applicant became British citizen is mandatory if relevant option was selected
* Place and country of birth is mandatory if relevant option was selected

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 10:04 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7452,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 12 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-24268&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-24268&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 12*

*Given* I have  selected the option to Continue on page 11

*Then* I will be prompted to enter the information shown on page 12 (wireframe below)

!image-20230907-092354.png|width=2271,height=2393!

*AC2 Page 12 validation*

*Given* I have entered the information on Page 12

*And* I have broken any of the following rules:

* at least 1 option for Application preferences must be checked
* at least 1 option from the voting method must be selected

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 10:20 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7453,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 12 of 14 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-24699&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-24699&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 

*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]



*AC1 Page 13*

*Given* I have  selected the option to Continue on page 12

*Then* I will be prompted to enter the information shown on page 13 (wireframe below)

!image-20230907-092800.png|width=2271,height=2393!

*AC2 Page 13 validation*

*Given* I have entered the information on Page 13

*And* I have broken any of the following rules:

* date cannot be in the future
* date is mandatory

*When* I select the Continue option

*Then* appropriate validation messages will be displayed

*And* I will not be able to go to the next page",To Do,,Shane.yin,,07/Sep/23 10:26 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,3.0,,,,Beta|OE|Refined|UI|Valtech,,,,
EIP1-7454,Three,,Story,"*As an* ERO
*I want* to create new OE applications in the EROP 
*so that*  I can store and process those received on paper or in person

*Assumptions*

* [https://technologyprogramme.atlassian.net/browse/EIP1-5291|https://technologyprogramme.atlassian.net/browse/EIP1-5291|smart-link]  will be Done
* This story will deal with the creation of page 9 of 9 pages

* [https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-25020&mode=design&t=ghS6fFTqUjT7qfV2-4|https://www.figma.com/file/j9bnPoOWOs9YqswFXq3H6E/DLUHC-Page-layouts-OE?type=design&node-id=27-25020&mode=design&t=ghS6fFTqUjT7qfV2-4|smart-link] 



*Process flow:*

[https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|https://miro.com/app/board/uXjVMm9vHfE=/?share_link_id=186089647844|smart-link]

*AC1 Page 14*

*Given* I have selected the option to Continue on page 13

*Then* an application reference will be generated 

*AND* a NINO check will be triggered (if NINO provided)

*AND* a check against the electoral register (EMS) will be triggered

*AND* the information shown on page 14 (wireframe below) will be displayed

*And* I will be provided with options to:

* go back to the previous page
* view application - opens the applications details
* Create an application - opens an application creation blank page 1 

Page 14

!Screenshot 2023-03-15 at 17.40.00.png|width=664,height=199!",To Do,,Shane.yin,,07/Sep/23 10:29 AM,11/Sep/23 12:49 PM,,,,EIP1-5177,,2.0,,,,Beta|OAVA|OE|Refined|UI|Valtech,,,,
EIP1-7462,Three,,Story,this ticket will cover the re-run of register checks when an applicant’s details are edited,To Do,,Krister Bone,,08/Sep/23 2:54 PM,12/Sep/23 1:05 AM,,,,EIP1-4886,,,,,,Beta|OE|Valtech,,,,
EIP1-7471,Three,,Story,"As an ERO administrator 

I want to edit an electors details 

so that i can update applications correctly 

----

h2. Notes 

This ticket covers editing an applicant’s name change details from the application details tab of an overseas elector application 

which relates to page 1 & 4of the manual creation journey

 [https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 

[https://technologyprogramme.atlassian.net/browse/EIP1-7442|https://technologyprogramme.atlassian.net/browse/EIP1-7442|smart-link] 



----

h2. Acceptance Criteria

h3. Scenario 1 - Edit name change details, name not changed 

*Given* an OE  Application
*When* viewing the Application Details Tab Elector Details section

*AND* has answered ‘No’ to name changed since registered to vote 
*Then* the ‘Change’ option should display for:

* Applicant name changed since last registered to vote 

h3. Scenario 2 - Edit name change details, name changed 

*Given* an OE  Application
*When* viewing the Application Details Tab Elector Details section

*AND* has answered ‘Yes’ to name changed since registered to vote 
*Then* the ‘Change’ option should display for:

* Applicant name changed since last registered to vote 
* Previous first ‘given’ name 
* middle names 
* Previous last ‘family’ name 
* Reason for name change. 

h3. Scenario 3- Edit Initiated

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*And* I click the ‘Change’ option for Applicant name changed since last registered to vote 

*Then* I am displayed the Edit view  [https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 
*And* can manually edit the selection 

h3. Scenario 4 - Edit Initiated

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*And* I click the ‘Change’ any previous name details from scenario 3 

*Then* I am displayed the Edit view  [https://technologyprogramme.atlassian.net/browse/EIP1-7442|https://technologyprogramme.atlassian.net/browse/EIP1-7442|smart-link] 
*And* can manually edit the selection 

h3. Scenario 7 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved

h3. Scenario 8 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab

h3. Scenario 9 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,11/Sep/23 3:18 AM,11/Sep/23 10:34 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7472,Three,,Story,"*As a* OE Admin
*In order to* ensure the DOB details are correct
*I want to* be able to edit an applicant’s national insurance number 

----

h2. Context

When processing proxy applications, administrators may need to edit the *DOB* to ensure the data is accurate. 

This ticket relates to manual creation page  [https://technologyprogramme.atlassian.net/browse/EIP1-7444|https://technologyprogramme.atlassian.net/browse/EIP1-7444|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit Option

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section
*Then* the ‘Change’ option should display for:

* National insurance number 

h3. Scenario 2 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ option for date of birth 
*Then* I am displayed the Edit view for National Insurance number [https://technologyprogramme.atlassian.net/browse/EIP1-7444|https://technologyprogramme.atlassian.net/browse/EIP1-7444|smart-link] 
*And* an ERO can manually edit the details 

h3. Scenario 3 - National Insurance Number 

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to change the National Insurance number 
*And* validation rules from the creation are inherited 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,11/Sep/23 4:13 AM,11/Sep/23 10:35 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7473,Three,,Story,"*As a* OE Admin
*In order to* ensure the previous addres details are correct
*I want to* be able to edit the previous address details data

----

h2. Context

When processing proxy applications, administrators may need to edit the address an applicant has lived at in the last 12 months if relevant 

Based on page 11 of the following pages in the manual application route

[https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 

[https://technologyprogramme.atlassian.net/browse/EIP1-7441|https://technologyprogramme.atlassian.net/browse/EIP1-7441|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit details, not moved house in last 12 months 

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section

*AND* has selected that they have not moved house in the last 12 months 
*Then* the ‘Change’ option should display for:

* Applicant has moved house in last 12 months 

h3. Scenario 2 - Edit details, moved house in last 12 months 

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section

*AND* has selected that they have moved house in the last 12 months 
*Then* the ‘Change’ option should display for:

* Applicant has moved house in last 12 months 
* Previous address in the last year 

h3. Scenario 3 - Edit Applicant has moved house in last 12 months 

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change link’ for Applicant has moved house in last 12 months 
*Then* I am displayed the page to edit this information [https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 

*And* I can manually update the application details 

h3. Scenario 4 - Edit Previous address in the last 12 months  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change link’ for ‘Previous address in the last year’ 
*Then* I am displayed the page to edit this information [https://technologyprogramme.atlassian.net/browse/EIP1-7441|https://technologyprogramme.atlassian.net/browse/EIP1-7441|smart-link] 

*And* I can manually update the application details 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,11/Sep/23 4:17 AM,12/Sep/23 12:28 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7474,Three,,Story,"*As a* OE Admin
*In order to* ensure the British citizenship details are correct
*I want to* be able to edit the British citizenship details data

----

h2. Context

When processing overseas elector applications, administrators may need to edit the application details

Based on page 1 of the manual creation route 

[https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit application details 

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section 
*Then* the ‘Change’ option should display for 

* Preferred communication language 
* Date application received
* Application method 

h3. Scenario 3 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ for any application data point from scenario 1
*Then* I am displayed the page to edit this information [https://technologyprogramme.atlassian.net/browse/EIP1-7439|https://technologyprogramme.atlassian.net/browse/EIP1-7439|smart-link] 

And I can manually update the application details 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,11/Sep/23 7:03 AM,11/Sep/23 10:34 PM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7475,Three,,Story,"*As a* OE Admin
*In order to* ensure the application preferences are correct 
*I want to* be able to edit the application preferences

----

h2. Context

When processing overseas elector applications, administrators may need to edit the application preferences

Based on page 1 of the manual creation route 

[https://technologyprogramme.atlassian.net/browse/EIP1-7452|https://technologyprogramme.atlassian.net/browse/EIP1-7452|smart-link] 

----

h2. Acceptance Criteria 

h3. Scenario 1 - Edit application details 

*Given* a OE Application
*When* viewing the Application Details Tab Elector Details section 
*Then* the ‘Change’ option should display for 

* Voting method 
* Register preferences 

h3. Scenario 3 - Edit Initiated  

*Given* a OE Application
*When* viewing the Application details tab 
*And* I click the ‘Change’ for any application data point from scenario 1
*Then* I am displayed the page to edit this information [https://technologyprogramme.atlassian.net/browse/EIP1-7452|https://technologyprogramme.atlassian.net/browse/EIP1-7452|smart-link] 

And I can manually update the application details 

h3. Scenario 4 - Save - Fail Validation

*Given* a OE Application
*When* I have saved changes 
*And* the values I have provided fail validation
*Then* I am presented with the appropriate validation messages when validation rules are broken
*And* I am unable to continue
*And* no changes are saved 

h3. Scenario 5 - Save - Pass Validation

*Given* a OE Application
*When* I have saved changes
*And* the values I have provided pass validation
*Then* my changes are saved 
*And* I am returned to the Application Details tab 

h3. Scenario 6 - Cancel

*Given* a OE Application
*When* viewing the Edit screen
*Then* I must be able to ‘Cancel’ and return to the Application Details tab
*And* no changes are saved",To Do,,yusuf.eldin,,11/Sep/23 7:17 AM,12/Sep/23 12:34 AM,,,,EIP1-4886,,,,,,Beta|OE|Refined|Valtech,,,,
EIP1-7479,Three,,Story,"*As an* ERO Overseas Admin
*I want* applications to be checked against DWP services
*So that* I can see if the Elector’s NINo matches
*And* that I can see if the Elector’s or their Parent / Guardian's historical address matches

----

*Technical Notes*

This will create the ability for the overseas service to receive SQS messages back from the DWP service. 

The DWP check could be for the elector identity, or for the elector or the elector’s parent / guardian qualifying address check.

----

*AC1:*
*Given* the DWP service queues a response for a overseas service DWP identity check request
*When* the service retrieves the message
*Then* the status of the applications identity check will be updated with the response.



*AC2:*
*Given* the DWP service queues a response for a overseas service DWP address check request
*When* the service retrieves the message
*Then* the status of the applications qualifying address check will be updated with the response.",To Do,,Krister Bone,,12/Sep/23 12:55 AM,12/Sep/23 1:00 AM,,,,EIP1-5177,,,,,,Beta|OAVA|OE|Refined|Valtech,,,,
